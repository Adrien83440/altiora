<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ALTEORE ‚Äî Connexion</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --blue-dark:  #0f1f5c;
      --blue-main:  #1a3dce;
      --blue-light: #4f7ef8;
      --blue-ghost: #f0f4ff;
      --white:      #ffffff;
      --text:       #1a1f36;
      --muted:      #6b7280;
      --border:     #e2e8f0;
      --error:      #ef4444;
      --success:    #10b981;
      --radius:     12px;
    }
    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
      min-height: 100vh;
      display: flex;
      background: #f0f4ff;
      overflow: hidden;
    }

    /* LEFT */
    .left-panel {
      width: 52%;
      background: linear-gradient(145deg, #0f1f5c 0%, #1a3dce 55%, #4f7ef8 100%);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 48px;
      position: relative;
      overflow: hidden;
    }
    .left-panel::before {
      content:''; position:absolute; top:-80px; right:-80px;
      width:380px; height:380px;
      background:radial-gradient(circle,rgba(99,102,241,.35) 0%,transparent 70%);
      border-radius:50%;
    }
    .left-panel::after {
      content:''; position:absolute; bottom:-100px; left:-60px;
      width:420px; height:420px;
      background:radial-gradient(circle,rgba(59,130,246,.3) 0%,transparent 70%);
      border-radius:50%;
    }
    .blob {
      position:absolute; width:200px; height:200px;
      background:rgba(255,255,255,.04); border-radius:50%;
      top:38%; left:30%; filter:blur(40px);
    }
    .panel-content { position:relative; z-index:1; }
    .logo { display:flex; align-items:center; gap:12px; margin-bottom:64px; }
    .logo-icon {
      width:42px; height:42px;
      background:rgba(255,255,255,.15);
      border:1px solid rgba(255,255,255,.25);
      border-radius:10px;
      display:flex; align-items:center; justify-content:center;
      font-size:18px;
    }
    .logo-text { font-size:22px; font-weight:800; color:white; letter-spacing:1px; }
    .panel-headline { font-size:38px; font-weight:800; color:white; line-height:1.2; margin-bottom:20px; letter-spacing:-0.5px; }
    .panel-headline span { background:linear-gradient(90deg,#a5b4fc,#7dd3fc); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
    .panel-sub { font-size:15px; color:rgba(255,255,255,.65); line-height:1.7; max-width:380px; margin-bottom:48px; }
    .features { display:flex; flex-direction:column; gap:14px; }
    .feature {
      display:flex; align-items:center; gap:14px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      border-radius:12px; padding:14px 18px;
    }
    .feature-icon { width:36px; height:36px; background:rgba(255,255,255,.15); border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:16px; flex-shrink:0; }
    .feature-text { font-size:13px; color:rgba(255,255,255,.8); font-weight:500; }
    .panel-footer { font-size:12px; color:rgba(255,255,255,.4); position:relative; z-index:1; }

    /* RIGHT */
    .right-panel {
      flex:1; display:flex; align-items:center; justify-content:center;
      padding:48px 40px; background:white; overflow-y:auto;
      animation: fadeUp .5s ease both;
    }
    .auth-container { width:100%; max-width:400px; }
    .auth-header { margin-bottom:32px; }
    .auth-title { font-size:26px; font-weight:800; color:var(--text); margin-bottom:6px; letter-spacing:-.3px; }
    .auth-sub { font-size:14px; color:var(--muted); }

    .tabs { display:flex; border-bottom:2px solid var(--border); margin-bottom:28px; }
    .tab { padding:10px 20px; font-family:'Plus Jakarta Sans',sans-serif; font-size:14px; font-weight:600; color:var(--muted); background:none; border:none; border-bottom:2px solid transparent; margin-bottom:-2px; cursor:pointer; transition:all .2s; }
    .tab.active { color:var(--blue-main); border-bottom-color:var(--blue-main); }

    .form { display:none; flex-direction:column; gap:18px; }
    .form.active { display:flex; }
    .field { display:flex; flex-direction:column; gap:7px; }
    label { font-size:13px; font-weight:600; color:var(--text); }
    .field-row { display:flex; justify-content:space-between; align-items:center; }
    .input-wrap { position:relative; }
    .input-icon { position:absolute; left:13px; top:50%; transform:translateY(-50%); color:var(--muted); font-size:15px; pointer-events:none; }
    input {
      width:100%; padding:11px 14px 11px 38px;
      background:var(--blue-ghost); border:1.5px solid var(--border);
      border-radius:var(--radius); color:var(--text);
      font-family:'Plus Jakarta Sans',sans-serif; font-size:14px;
      outline:none; transition:all .2s;
    }
    input:focus { border-color:var(--blue-main); background:white; box-shadow:0 0 0 3px rgba(26,61,206,.08); }
    input::placeholder { color:#b0b8c8; }

    .forgot { font-size:12px; font-weight:600; color:var(--blue-main); background:none; border:none; cursor:pointer; padding:0; }
    .forgot:hover { text-decoration:underline; }

    .btn {
      width:100%; padding:13px;
      background:linear-gradient(135deg, var(--blue-main) 0%, var(--blue-light) 100%);
      color:white; border:none; border-radius:var(--radius);
      font-family:'Plus Jakarta Sans',sans-serif; font-weight:700; font-size:15px;
      cursor:pointer; transition:all .25s;
      box-shadow:0 4px 15px rgba(26,61,206,.35); letter-spacing:.2px;
    }
    .btn:hover { transform:translateY(-1px); box-shadow:0 6px 20px rgba(26,61,206,.45); }
    .btn:active { transform:translateY(0); }
    .btn:disabled { opacity:.5; cursor:not-allowed; transform:none; }
    .btn-outline { background:transparent; color:var(--blue-main); border:1.5px solid var(--border); box-shadow:none; }
    .btn-outline:hover { border-color:var(--blue-main); background:var(--blue-ghost); box-shadow:none; transform:none; }

    .alert { padding:11px 14px; border-radius:10px; font-size:13px; display:none; line-height:1.4; font-weight:500; }
    .alert.error { background:#fef2f2; border:1px solid #fecaca; color:var(--error); display:block; }
    .alert.success { background:#f0fdf4; border:1px solid #bbf7d0; color:var(--success); display:block; }

    .divider { display:flex; align-items:center; gap:12px; color:var(--muted); font-size:12px; font-weight:500; }
    .divider::before, .divider::after { content:''; flex:1; height:1px; background:var(--border); }

    @keyframes spin { to { transform:rotate(360deg); } }
    .spinner { width:15px; height:15px; border:2px solid rgba(255,255,255,.3); border-top-color:white; border-radius:50%; animation:spin .7s linear infinite; display:inline-block; vertical-align:middle; margin-right:6px; }

    #dashboard { display:none; text-align:center; }
    .success-icon { width:64px; height:64px; background:linear-gradient(135deg,var(--blue-main),var(--blue-light)); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:28px; margin:0 auto 20px; box-shadow:0 8px 24px rgba(26,61,206,.3); color:white; font-weight:800; }
    #dashboard h2 { font-size:22px; font-weight:800; color:var(--text); margin-bottom:8px; }
    #dashboard p { font-size:14px; color:var(--muted); margin-bottom:28px; line-height:1.6; }

    @keyframes fadeUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

    @media (max-width:768px) {
      body { flex-direction:column; overflow:auto; }
      .left-panel { width:100%; padding:32px 24px; min-height:auto; }
      .panel-headline { font-size:26px; }
      .features { display:none; }
      .right-panel { padding:32px 24px; }
    }
  </style>
</head>
<body>

<div class="left-panel">
  <div class="blob"></div>
  <div class="panel-content">
    <div class="logo">
      <div class="logo-icon">üìä</div>
      <div class="logo-text">ALTEORE</div>
    </div>
    <div class="panel-headline">Pilotez votre<br/>entreprise<br/><span>avec pr√©cision</span></div>
    <p class="panel-sub">La solution tout-en-un pour les dirigeants qui veulent des chiffres clairs, des d√©cisions rapides et une croissance ma√Ætris√©e.</p>
    <div class="features">
      <div class="feature"><div class="feature-icon">üìà</div><div class="feature-text">Tableau de bord en temps r√©el</div></div>
      <div class="feature"><div class="feature-icon">üí∞</div><div class="feature-text">Suivi des marges et du CA</div></div>
      <div class="feature"><div class="feature-icon">üéØ</div><div class="feature-text">Simulation et pilotage strat√©gique</div></div>
    </div>
  </div>
  <div class="panel-footer">¬© 2026 ALTEORE ‚Äî Tous droits r√©serv√©s</div>
</div>

<div class="right-panel">
  <div class="auth-container">

    <div id="authCard">
      <div class="auth-header">
        <div class="auth-title" id="authTitle">Bon retour üëã</div>
        <div class="auth-sub" id="authSub">Connectez-vous √† votre espace ALTIORA</div>
      </div>
      <div class="tabs">
        <button class="tab active" onclick="switchTab('login')">Connexion</button>
        <button class="tab" onclick="switchTab('register')">Cr√©er un compte</button>
      </div>

      <form class="form active" id="loginForm" onsubmit="handleLogin(event)">
        <div id="loginAlert" class="alert"></div>
        <div class="field">
          <label>Adresse email</label>
          <div class="input-wrap">
            <span class="input-icon">‚úâ</span>
            <input type="email" id="loginEmail" placeholder="vous@exemple.com" required />
          </div>
        </div>
        <div class="field">
          <div class="field-row">
            <label>Mot de passe</label>
            <button type="button" class="forgot" onclick="switchTab('reset')">Oubli√© ?</button>
          </div>
          <div class="input-wrap">
            <span class="input-icon">üîí</span>
            <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
          </div>
        </div>
        <button class="btn" type="submit" id="loginBtn">Se connecter ‚Üí</button>
        <div class="divider">ou</div>
        <button type="button" class="btn btn-outline" onclick="switchTab('register')">Cr√©er un compte gratuit</button>
      </form>

      <form class="form" id="registerForm" onsubmit="handleRegister(event)">
        <div id="registerAlert" class="alert"></div>
        <div class="field">
          <label>Pr√©nom &amp; Nom</label>
          <div class="input-wrap">
            <span class="input-icon">üë§</span>
            <input type="text" id="registerName" placeholder="Jean Dupont" required />
          </div>
        </div>
        <div class="field">
          <label>Adresse email</label>
          <div class="input-wrap">
            <span class="input-icon">‚úâ</span>
            <input type="email" id="registerEmail" placeholder="vous@exemple.com" required />
          </div>
        </div>
        <div class="field">
          <label>Mot de passe</label>
          <div class="input-wrap">
            <span class="input-icon">üîí</span>
            <input type="password" id="registerPassword" placeholder="8 caract√®res minimum" required minlength="8" />
          </div>
        </div>
        <button class="btn" type="submit" id="registerBtn">Cr√©er mon compte ‚Üí</button>
        <div class="divider">ou</div>
        <button type="button" class="btn btn-outline" onclick="switchTab('login')">J'ai d√©j√† un compte</button>
      </form>

      <form class="form" id="resetForm" onsubmit="handleReset(event)">
        <div id="resetAlert" class="alert"></div>
        <p style="font-size:13px;color:var(--muted);line-height:1.6;">Entrez votre email pour recevoir un lien de r√©initialisation.</p>
        <div class="field">
          <label>Adresse email</label>
          <div class="input-wrap">
            <span class="input-icon">‚úâ</span>
            <input type="email" id="resetEmail" placeholder="vous@exemple.com" required />
          </div>
        </div>
        <button class="btn" type="submit" id="resetBtn">Envoyer le lien ‚Üí</button>
        <div class="divider">ou</div>
        <button type="button" class="btn btn-outline" onclick="switchTab('login')">‚Üê Retour √† la connexion</button>
      </form>
    </div>

    <div id="dashboard">
      <div class="success-icon">‚úì</div>
      <h2>Bienvenue sur ALTEORE !</h2>
      <p id="welcomeMsg">Vous √™tes bien connect√©.<br/>Votre espace de pilotage est pr√™t.</p>
      <button class="btn" style="margin-bottom:12px;" onclick="goToDashboard()">Acc√©der au tableau de bord ‚Üí</button>
      <button class="btn btn-outline" onclick="handleLogout()">Se d√©connecter</button>
    </div>

  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, updateProfile, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const app = initializeApp({
    apiKey: "AIzaSyB003WqdRKrT0gbv7P4BNIICuXeqbu8dR4",
    authDomain: "altiora-70599.firebaseapp.com",
    projectId: "altiora-70599",
    storageBucket: "altiora-70599.firebasestorage.app",
    messagingSenderId: "120905555746",
    appId: "1:120905555746:web:618460c65cdc9e57cc8f7b"
  });

  const auth = getAuth(app);
  const db = getFirestore(app);

  window._auth = auth; window._db = db;
  window._signIn = signInWithEmailAndPassword;
  window._createUser = createUserWithEmailAndPassword;
  window._resetPwd = sendPasswordResetEmail;
  window._updateProfile = updateProfile;
  window._signOut = signOut;
  window._setDoc = setDoc;
  window._doc = doc;
  window._serverTimestamp = serverTimestamp;

  onAuthStateChanged(auth, user => user ? showDashboard(user) : showAuth());
</script>

<script>
  const titles = {
    login:    ['Bon retour üëã', 'Connectez-vous √† votre espace ALTIORA'],
    register: ['Cr√©er un compte', 'Commencez gratuitement, sans carte bancaire'],
    reset:    ['Mot de passe oubli√© ?', 'R√©initialisez votre acc√®s en quelques secondes']
  };

  function switchTab(tab) {
    document.querySelectorAll('.form').forEach(f => f.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(tab + 'Form').classList.add('active');
    if (tab === 'login') document.querySelectorAll('.tab')[0].classList.add('active');
    if (tab === 'register') document.querySelectorAll('.tab')[1].classList.add('active');
    document.getElementById('authTitle').textContent = titles[tab][0];
    document.getElementById('authSub').textContent = titles[tab][1];
    document.querySelectorAll('.alert').forEach(a => { a.className = 'alert'; a.textContent = ''; });
  }

  function showAlert(id, msg, type='error') {
    const el = document.getElementById(id);
    el.className = 'alert ' + type;
    el.textContent = msg;
  }

  function setLoading(id, loading, label) {
    const btn = document.getElementById(id);
    btn.disabled = loading;
    btn.innerHTML = loading ? '<span class="spinner"></span>Chargement...' : label;
  }

  function firebaseError(code) {
    return ({'auth/user-not-found':'Aucun compte avec cet email.','auth/wrong-password':'Mot de passe incorrect.','auth/invalid-credential':'Email ou mot de passe incorrect.','auth/email-already-in-use':'Un compte existe d√©j√† avec cet email.','auth/weak-password':'Mot de passe trop faible (8 caract√®res minimum).','auth/invalid-email':'Adresse email invalide.','auth/too-many-requests':'Trop de tentatives. R√©essayez dans quelques minutes.'})[code] || 'Une erreur est survenue. R√©essayez.';
  }

  async function handleLogin(e) {
    e.preventDefault();
    setLoading('loginBtn', true, 'Se connecter ‚Üí');
    try {
      await window._signIn(window._auth, document.getElementById('loginEmail').value, document.getElementById('loginPassword').value);
    } catch(err) {
      showAlert('loginAlert', firebaseError(err.code));
      setLoading('loginBtn', false, 'Se connecter ‚Üí');
    }
  }

  async function handleRegister(e) {
    e.preventDefault();
    setLoading('registerBtn', true, 'Cr√©er mon compte ‚Üí');
    const name = document.getElementById('registerName').value;
    const email = document.getElementById('registerEmail').value;
    const password = document.getElementById('registerPassword').value;
    try {
      const cred = await window._createUser(window._auth, email, password);
      await window._updateProfile(cred.user, { displayName: name });
      await window._setDoc(window._doc(window._db, 'users', cred.user.uid), { name, email, createdAt: window._serverTimestamp(), plan: 'free' });
    } catch(err) {
      showAlert('registerAlert', firebaseError(err.code));
      setLoading('registerBtn', false, 'Cr√©er mon compte ‚Üí');
    }
  }

  async function handleReset(e) {
    e.preventDefault();
    setLoading('resetBtn', true, 'Envoyer le lien ‚Üí');
    try {
      await window._resetPwd(window._auth, document.getElementById('resetEmail').value);
      showAlert('resetAlert', '‚úì Email envoy√© ! V√©rifiez votre bo√Æte mail.', 'success');
    } catch(err) {
      showAlert('resetAlert', firebaseError(err.code));
    }
    setLoading('resetBtn', false, 'Envoyer le lien ‚Üí');
  }

  async function handleLogout() { await window._signOut(window._auth); }

  function showDashboard(user) {
    document.getElementById('authCard').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
    document.getElementById('welcomeMsg').innerHTML = `Connect√© en tant que <strong>${user.email}</strong><br/>Les modules arrivent brique par brique üöÄ`;
  }

  function showAuth() {
    document.getElementById('authCard').style.display = 'block';
    document.getElementById('dashboard').style.display = 'none';
  }

  function goToDashboard() { window.location.href = 'dashboard.html'; }
  
  window.switchTab = switchTab;
  window.handleLogin = handleLogin;
  window.handleRegister = handleRegister;
  window.handleReset = handleReset;
  window.handleLogout = handleLogout;
  window.goToDashboard = goToDashboard;
</script>
</body>
</html>
