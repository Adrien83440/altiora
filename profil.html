<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover"/>
<title>ALTEORE â€” Mon Compte</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet"/>
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --blue:#1a3dce;--blue2:#4f7ef8;--bg:#f4f6fb;--white:#fff;
  --border:#e2e8f0;--text:#1a1f36;--muted:#6b7280;
  --green:#10b981;--red:#ef4444;--orange:#f59e0b;--purple:#6366f1;
  --radius:14px;--sw:250px;
}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--text);display:flex;min-height:100vh;font-size:13px}

/* NAV */
nav{width:var(--sw);min-height:100vh;background:linear-gradient(180deg,#0f1f5c,#162366);position:fixed;top:0;left:0;display:flex;flex-direction:column;padding-bottom:20px;overflow-y:auto;z-index:99}
.logo{display:flex;align-items:center;gap:10px;padding:22px 18px;border-bottom:1px solid rgba(255,255,255,.08)}
.logo-i{width:33px;height:33px;background:rgba(255,255,255,.14);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px}
.logo-t{font-size:17px;font-weight:800;color:#fff;letter-spacing:1px}
.ns{font-size:10px;font-weight:700;color:rgba(255,255,255,.28);letter-spacing:1px;text-transform:uppercase;padding:12px 18px 4px}
.ni{display:flex;align-items:center;gap:9px;padding:9px 18px;color:rgba(255,255,255,.55);font-size:12.5px;font-weight:500;cursor:pointer;border-left:3px solid transparent;transition:.15s}
.ni:hover{color:#fff;background:rgba(255,255,255,.06)}
.ni.on{color:#fff;background:rgba(255,255,255,.1);border-left-color:#4f7ef8}
.sub{overflow:hidden;max-height:0;transition:max-height .3s}
.sub.open{max-height:200px}
.si{display:flex;align-items:center;gap:7px;padding:7px 18px 7px 40px;color:rgba(255,255,255,.4);font-size:12px;cursor:pointer;border-left:3px solid transparent;transition:.15s}
.si:hover{color:rgba(255,255,255,.75);background:rgba(255,255,255,.04)}
.si.on{color:#fff;background:rgba(79,126,248,.15);border-left-color:rgba(79,126,248,.6)}
.dot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.25)}
.si.on .dot{background:#4f7ef8}
.chev{font-size:11px;color:rgba(255,255,255,.3);transition:transform .25s;margin-left:auto}
.nav-footer{margin-top:auto;padding:12px 18px 0;border-top:1px solid rgba(255,255,255,.08)}
.ucard{display:flex;align-items:center;gap:8px;padding:8px;background:rgba(255,255,255,.07);border-radius:8px}
.uav{width:29px;height:29px;background:linear-gradient(135deg,#4f7ef8,#6366f1);border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff}
.un{font-size:11.5px;font-weight:600;color:#fff}
.upl{font-size:10px;color:rgba(255,255,255,.3)}
.lbtn{margin-left:auto;background:none;border:none;color:rgba(255,255,255,.3);cursor:pointer;font-size:13px}

/* MAIN */
main{margin-left:var(--sw);flex:1;display:flex;flex-direction:column}
.topbar{background:#fff;border-bottom:1px solid var(--border);padding:12px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:50}
.topbar h1{font-size:16px;font-weight:700}
.topbar p{font-size:11px;color:var(--muted)}
.tb-r{display:flex;gap:8px;align-items:center}
.btn{padding:7px 14px;border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;transition:.15s;display:inline-flex;align-items:center;gap:5px}
.btn-p{background:linear-gradient(135deg,var(--blue),var(--blue2));color:#fff;box-shadow:0 3px 10px rgba(26,61,206,.2)}
.btn-o{background:#fff;color:var(--blue);border:1.5px solid var(--border)}
.btn-o:hover{border-color:var(--blue2)}
.btn-xs{padding:4px 10px;font-size:11px}

/* PAGE */
.page{padding:20px 24px;display:flex;flex-direction:column;gap:20px}

/* PROFIL HERO */
.hero{background:linear-gradient(135deg,#0f1f5c,#1a3dce,#4f7ef8);border-radius:var(--radius);padding:28px 32px;display:flex;align-items:center;gap:24px;color:#fff;position:relative;overflow:hidden}
.hero::before{content:'';position:absolute;right:-40px;top:-40px;width:200px;height:200px;border-radius:50%;background:rgba(255,255,255,.05)}
.hero::after{content:'';position:absolute;right:60px;bottom:-60px;width:150px;height:150px;border-radius:50%;background:rgba(255,255,255,.04)}
.hero-logo{width:72px;height:72px;background:rgba(255,255,255,.15);border:2px solid rgba(255,255,255,.25);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:30px;cursor:pointer;flex-shrink:0;position:relative;transition:.2s}
.hero-logo:hover{background:rgba(255,255,255,.22)}
.hero-logo-hint{position:absolute;bottom:-6px;right:-6px;width:20px;height:20px;background:var(--blue2);border:2px solid #fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px}
.hero-info{flex:1;min-width:0}
.hero-name{font-size:22px;font-weight:800;margin-bottom:4px}
.hero-sub{font-size:13px;opacity:.7;margin-bottom:8px}
.hero-tags{display:flex;gap:8px;flex-wrap:wrap}
.hero-tag{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.2)}
.hero-right{text-align:right;flex-shrink:0}
.plan-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:700;margin-bottom:8px}
.plan-gratuit{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.3);color:#fff}
.plan-pro{background:linear-gradient(135deg,#f59e0b,#fbbf24);color:#1a1f36}
.plan-business{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff}
.hero-member{font-size:11px;opacity:.5}

/* TABS */
.tabs{display:flex;gap:2px;background:#f1f5f9;border-radius:10px;padding:4px;width:fit-content}
.tab{padding:7px 18px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;color:var(--muted);transition:.15s;border:none;background:transparent;font-family:'Plus Jakarta Sans',sans-serif}
.tab.on{background:#fff;color:var(--blue);box-shadow:0 1px 4px rgba(0,0,0,.1)}

/* PANELS */
.panel{display:none}.panel.on{display:flex;flex-direction:column;gap:16px}

/* CARDS */
.card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.card-head{padding:14px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:#f8faff}
.card-title{font-size:13px;font-weight:700;display:flex;align-items:center;gap:7px}
.card-body{padding:20px}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}

/* FIELDS */
.field{display:flex;flex-direction:column;gap:5px}
.field label{font-size:11px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.4px}
.field-wrap{display:flex;align-items:center;gap:8px;padding:9px 13px;border:1.5px solid var(--border);border-radius:10px;background:#f8faff;transition:.15s}
.field-wrap:focus-within{border-color:var(--blue2);background:#fff;box-shadow:0 0 0 3px rgba(79,126,248,.1)}
.field-in{flex:1;border:none;background:transparent;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;color:var(--text);outline:none}
.field-in::placeholder{color:#cbd5e1;font-weight:400}
.field-sel{flex:1;border:none;background:transparent;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;color:var(--text);outline:none;cursor:pointer}
.field-unit{font-size:11px;font-weight:700;color:var(--muted)}
.field-full{grid-column:1/-1}

/* LOGO UPLOAD */
.logo-upload{display:flex;align-items:center;gap:16px;padding:16px;background:#f8faff;border:2px dashed var(--border);border-radius:10px;cursor:pointer;transition:.15s}
.logo-upload:hover{border-color:var(--blue2);background:#eff6ff}
.logo-preview{width:56px;height:56px;border-radius:10px;background:#e2e8f0;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;overflow:hidden}
.logo-preview img{width:100%;height:100%;object-fit:contain}
.logo-upload-text div:first-child{font-size:13px;font-weight:700;color:var(--text);margin-bottom:2px}
.logo-upload-text div:last-child{font-size:11px;color:var(--muted)}

/* PLAN CARDS */
.plan-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.plan-card{background:#fff;border:2px solid var(--border);border-radius:var(--radius);padding:20px;text-align:center;cursor:pointer;transition:.2s;position:relative}
.plan-card:hover{border-color:var(--blue2);transform:translateY(-2px);box-shadow:0 8px 24px rgba(79,126,248,.12)}
.plan-card.current{border-color:var(--blue);box-shadow:0 0 0 3px rgba(79,126,248,.12)}
.plan-card.current::after{content:'âœ“ Plan actuel';position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:var(--blue);color:#fff;font-size:10px;font-weight:700;padding:2px 10px;border-radius:20px}
.plan-card.popular::before{content:'â­ Populaire';position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:var(--orange);color:#fff;font-size:10px;font-weight:700;padding:2px 10px;border-radius:20px}
.plan-icon{font-size:28px;margin-bottom:10px}
.plan-name{font-size:15px;font-weight:800;margin-bottom:4px}
.plan-price{font-size:26px;font-weight:800;color:var(--blue);margin:8px 0}
.plan-price span{font-size:13px;font-weight:500;color:var(--muted)}
.plan-desc{font-size:11px;color:var(--muted);margin-bottom:14px}
.plan-features{text-align:left;display:flex;flex-direction:column;gap:6px;font-size:12px}
.plan-feat{display:flex;align-items:center;gap:7px}
.plan-feat.ok{color:var(--text)}
.plan-feat.no{color:var(--muted);text-decoration:line-through}
.plan-feat-icon{flex-shrink:0}
.plan-cta{margin-top:16px;width:100%;padding:9px;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer;border:none;transition:.15s}
.plan-cta-current{background:#f1f5f9;color:var(--muted);cursor:default}
.plan-cta-upgrade{background:linear-gradient(135deg,var(--blue),var(--blue2));color:#fff}

/* FACTURES */
.fact-kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.fkpi{background:#fff;border:1px solid var(--border);border-radius:12px;padding:14px 16px}
.fkpi.green{background:#f0fdf4;border-color:#bbf7d0}
.fkpi.orange{background:#fffbeb;border-color:#fde68a}
.fkpi.red{background:#fef2f2;border-color:#fecaca}
.fkpi.blue{background:#eff6ff;border-color:#bfdbfe}
.fkpi-ico{font-size:18px;margin-bottom:4px}
.fkpi-lbl{font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.3px}
.fkpi-val{font-size:18px;font-weight:800;margin-top:2px}
.fkpi-sub{font-size:10px;color:var(--muted);margin-top:1px}

/* TABLE FACTURES */
.fact-table{width:100%;border-collapse:collapse;font-size:12px}
.fact-table th{padding:9px 14px;text-align:left;font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;background:#f8faff;border-bottom:1px solid var(--border)}
.fact-table td{padding:11px 14px;border-bottom:1px solid #f1f5f9;vertical-align:middle}
.fact-table tr:hover td{background:#fafbff}
.status-badge{display:inline-flex;align-items:center;gap:4px;padding:3px 9px;border-radius:20px;font-size:11px;font-weight:700}
.status-payee{background:#d1fae5;color:#065f46}
.status-attente{background:#fef3c7;color:#92400e}
.status-retard{background:#fee2e2;color:#b91c1c}
.dl-btn{padding:4px 10px;border:1.5px solid var(--border);border-radius:6px;background:#fff;font-family:'Plus Jakarta Sans',sans-serif;font-size:11px;font-weight:600;cursor:pointer;color:var(--blue);transition:.15s}
.dl-btn:hover{border-color:var(--blue2);background:#eff6ff}

/* DANGER ZONE */
.danger-zone{background:#fff;border:1.5px solid #fecaca;border-radius:var(--radius);padding:20px}
.danger-title{font-size:13px;font-weight:700;color:var(--red);margin-bottom:4px}
.danger-sub{font-size:12px;color:var(--muted);margin-bottom:14px}
.btn-danger{background:#fef2f2;color:var(--red);border:1.5px solid #fecaca;padding:8px 16px;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer}
.btn-danger:hover{background:#fee2e2}

/* SAVE BAR */
.save-bar{position:sticky;bottom:0;background:#fff;border-top:1px solid var(--border);padding:12px 24px;display:flex;align-items:center;justify-content:space-between;margin:-20px -24px 0;z-index:10}
.save-hint{font-size:12px;color:var(--muted)}

/* TOAST */
.toast{position:fixed;bottom:18px;right:18px;padding:10px 16px;border-radius:9px;font-size:13px;font-weight:600;z-index:9999;transform:translateY(60px);opacity:0;transition:.3s}
.toast.show{transform:translateY(0);opacity:1}
.toast.ok{background:#10b981;color:#fff}
.toast.err{background:#ef4444;color:#fff}

input[type=file]{display:none}


/* â”€â”€ MOBILE UNIQUEMENT â”€â”€ */





/* â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•‘   ALTIORA â€” RESPONSIVE MOBILE (iPhone/Android)  â•‘
   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* 1. RESET global overflow */
html, body { overflow-x: hidden; max-width: 100vw; }

/* 2. HAMBURGER â€” masquÃ© par dÃ©faut */
.hamburger {
  display: none;
  position: fixed;
  top: 14px; left: 14px;
  z-index: 1001;
  width: 44px; height: 44px;
  background: #0f1f5c;
  border: none; border-radius: 12px;
  cursor: pointer;
  flex-direction: column;
  align-items: center; justify-content: center;
  gap: 5px;
  box-shadow: 0 4px 16px rgba(15,31,92,.45);
  -webkit-tap-highlight-color: transparent;
  transition: background .2s;
}
.hamburger:active { background: #1a3dce; }
.hamburger span {
  display: block; width: 20px; height: 2.5px;
  background: #fff; border-radius: 2px;
  transition: all .25s ease;
  pointer-events: none;
}
.hamburger.open span:nth-child(1) { transform: translateY(7.5px) rotate(45deg); }
.hamburger.open span:nth-child(2) { opacity: 0; transform: scaleX(0); }
.hamburger.open span:nth-child(3) { transform: translateY(-7.5px) rotate(-45deg); }

/* 3. OVERLAY */
.nav-overlay {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,.5); z-index: 1000;
  -webkit-tap-highlight-color: transparent;
}
.nav-overlay.show { display: block; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MOBILE â‰¤768px â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 768px) {

  /* HAMBURGER visible */
  .hamburger { display: flex !important; }

  /* SIDEBAR / NAV â†’ drawer */
  nav, aside.sidebar, .sidebar {
    position: fixed !important;
    top: 0 !important; left: 0 !important;
    height: 100vh !important;
    height: -webkit-fill-available !important;
    width: min(280px, 84vw) !important;
    z-index: 1001 !important;
    transform: translateX(-105%) !important;
    transition: transform .3s cubic-bezier(.4,0,.2,1) !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }
  nav.open, aside.sidebar.open, .sidebar.open {
    transform: translateX(0) !important;
    box-shadow: 8px 0 32px rgba(0,0,0,.3) !important;
  }

  /* MAIN CONTENT â†’ pleine largeur */
  .main, main, div.main, .main-content {
    margin-left: 0 !important;
    width: 100vw !important;
    overflow-x: hidden !important;
    box-sizing: border-box !important;
  }

  /* TOPBAR */
  .topbar {
    padding: 10px 10px 10px 62px !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
    position: sticky !important;
    top: 0 !important; z-index: 50 !important;
    background: #fff !important;
    box-shadow: 0 1px 6px rgba(0,0,0,.08) !important;
    box-sizing: border-box !important;
    width: 100% !important;
  }
  .topbar h1, .topbar-left h1, .topbar-left h2 { font-size: 14px !important; }
  .topbar p, .topbar-left p { font-size: 10px !important; }
  .topbar-right, .tb-r {
    width: 100% !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
  }
  .topbar-right .btn, .tb-r .btn,
  .topbar-right button, .tb-r button {
    flex: 1 1 auto !important;
    font-size: 11px !important;
    padding: 7px 8px !important;
    min-height: 36px !important;
    white-space: nowrap !important;
    min-width: 0 !important;
  }

  /* PAGE / CONTENT */
  .content, .page {
    padding: 12px 10px !important;
    overflow-x: hidden !important;
    width: 100% !important;
    box-sizing: border-box !important;
    gap: 12px !important;
  }
  .content > *, .page > * {
    box-sizing: border-box !important;
    max-width: 100% !important;
  }

  /* â”€â”€ TOUTES LES GRILLES â†’ 1 COLONNE â”€â”€ */
  /* Dashboard */
  .kpi-grid-4, .kpi-grid-5 { grid-template-columns: 1fr 1fr !important; gap: 8px !important; margin-bottom: 12px !important; }
  .charts-grid, .charts-grid-3 { grid-template-columns: 1fr !important; gap: 12px !important; }
  /* Suivi CA */
  .kpi-grid { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .charts-grid-2 { grid-template-columns: 1fr !important; gap: 12px !important; }
  /* CoÃ»t de revient */
  .fiche-kpis { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .prix-grid { grid-template-columns: 1fr !important; gap: 10px !important; }
  /* Marges */
  .decomp-grid { grid-template-columns: 1fr !important; gap: 10px !important; }
  .cle-grid { grid-template-columns: 1fr !important; gap: 8px !important; }
  .cle-inputs { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .sim-levers { grid-template-columns: 1fr !important; gap: 8px !important; }
  .sim-result-grid { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .modal-row { grid-template-columns: 1fr !important; gap: 8px !important; }
  /* Pilotage */
  .summary-grid { grid-template-columns: 1fr 1fr !important; gap: 8px !important; margin-bottom: 12px !important; }
  .sections-grid { grid-template-columns: 1fr !important; gap: 12px !important; }
  .tva-result { grid-template-columns: 1fr !important; gap: 8px !important; }
  .cashflow-grid { grid-template-columns: 1fr !important; gap: 8px !important; }
  /* Panier moyen */
  .fields-grid { grid-template-columns: 1fr !important; gap: 10px !important; }
  .results-row { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .g2, .g3 { grid-template-columns: 1fr !important; gap: 12px !important; }
  .cats { grid-template-columns: 1fr !important; gap: 10px !important; }
  .sim-g { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .sim-rg { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  /* Dettes */
  .detail-grid { grid-template-columns: 1fr !important; gap: 10px !important; }
  .mgrid2 { grid-template-columns: 1fr !important; gap: 10px !important; }
  /* Profil */
  .plan-grid { grid-template-columns: 1fr !important; gap: 12px !important; }
  /* Universels */
  .kpi-row { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .type-grid { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .fact-kpis { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .calendar-grid { grid-template-columns: repeat(4, 1fr) !important; gap: 5px !important; }

  /* â”€â”€ KPI CARDS â€” texte lisible â”€â”€ */
  .kpi-card, .kpi, .summary-card, .fkpi {
    padding: 12px 10px !important;
    overflow: hidden !important;
    min-width: 0 !important;
  }
  .kpi-value, .kpi-val, .summary-value { font-size: 16px !important; letter-spacing: -0.3px !important; }
  .kpi-label, .kpi-lbl, .summary-label { font-size: 9px !important; line-height: 1.3 !important; }
  .kpi-sub { font-size: 10px !important; }

  /* â”€â”€ TABLEAUX â€” scroll interne propre â”€â”€ */
  .echeancier-wrap,
  div[style*="overflow-x"],
  .section-body, .section-content,
  .table-wrap, .table-card, .table-container,
  .card > div { overflow-x: auto !important; -webkit-overflow-scrolling: touch !important; }
  table { min-width: 460px !important; font-size: 11px !important; }
  
  /* â”€â”€ INPUTS TOUCH (Ã©vite zoom iOS) â”€â”€ */
  input[type=text], input[type=number], input[type=email],
  input[type=date], input[type=tel], input[type=password],
  select, textarea {
    font-size: 16px !important;
    -webkit-appearance: none !important;
  }
  .field-wrap, .mfield-wrap, .sim-fw {
    min-height: 46px !important;
    padding: 10px 12px !important;
  }

  /* â”€â”€ BOUTONS â”€â”€ */
  .btn { min-height: 40px !important; }
  .btn-xs, .btn-sm { min-height: 34px !important; }

  /* â”€â”€ PILOTAGE SUMMARY CARDS â”€â”€ */
  .summary-card .kpi-value,
  .summary-card .summary-value { white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; }
  .summary-card .kpi-sub,
  .summary-card .summary-sub { white-space: normal !important; font-size: 10px !important; }

  /* â”€â”€ SECTION HEAD â”€â”€ */
  .section-head { flex-wrap: wrap !important; gap: 6px !important; padding: 10px 12px !important; }
  .section-head .btn, .section-head button { font-size: 10px !important; padding: 4px 8px !important; }

  /* â”€â”€ MONTH STRIP (panier moyen) â”€â”€ */
  .month-strip { overflow-x: auto !important; -webkit-overflow-scrolling: touch !important; flex-wrap: nowrap !important; padding-bottom: 6px !important; }
  .mbtn { flex-shrink: 0 !important; }

  /* â”€â”€ YEAR BAR â”€â”€ */
  .yr-bar { overflow-x: auto !important; flex-wrap: nowrap !important; -webkit-overflow-scrolling: touch !important; }
  .yr { flex-shrink: 0 !important; }

  /* â”€â”€ TABS â”€â”€ */
  .tabs { overflow-x: auto !important; -webkit-overflow-scrolling: touch !important; flex-wrap: nowrap !important; width: 100% !important; }
  .tab { flex-shrink: 0 !important; white-space: nowrap !important; }

  /* â”€â”€ DETTE CARDS â”€â”€ */
  .dette-head { flex-wrap: wrap !important; gap: 8px !important; }
  .dette-stats { flex-direction: column !important; align-items: flex-start !important; gap: 4px !important; }

  /* â”€â”€ SAISIE (panier) â”€â”€ */
  .saisie-head { flex-direction: column !important; gap: 8px !important; align-items: flex-start !important; }

  /* â”€â”€ HERO (profil) â”€â”€ */
  .hero { flex-direction: column !important; text-align: center !important; padding: 16px !important; gap: 12px !important; }
  .hero-right { text-align: center !important; }
  .hero-tags { justify-content: center !important; }
  .hero-name { font-size: 17px !important; }

  /* â”€â”€ MODAL â†’ bottom sheet â”€â”€ */
  .overlay, .modal-overlay { align-items: flex-end !important; padding: 0 !important; }
  .modal {
    width: 100% !important; max-width: 100% !important;
    margin: 0 !important;
    border-radius: 18px 18px 0 0 !important;
    max-height: 92vh !important;
  }

  /* â”€â”€ CANVAS â”€â”€ */
  canvas { max-width: 100% !important; }

  /* â”€â”€ CONTEXT BAR (dashboard) â”€â”€ */
  .context-bar { flex-wrap: wrap !important; gap: 8px !important; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PETIT MOBILE â‰¤420px â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 420px) {
  .kpi-grid-4, .kpi-grid-5, .kpi-grid, .kpi-row,
  .fiche-kpis, .summary-grid, .fact-kpis,
  .type-grid, .results-row, .sim-g { grid-template-columns: 1fr !important; }
  .sim-rg, .sim-result-grid, .cle-inputs { grid-template-columns: 1fr !important; }
  .calendar-grid { grid-template-columns: repeat(3, 1fr) !important; }
}

</style>
</head>
<body>
  <button class="hamburger" id="hamburger" onclick="toggleSidebar()" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
  <div class="nav-overlay" id="navOverlay" onclick="closeSidebar()"></div>
<nav>
  <div class="logo"><div class="logo-i">ğŸ“Š</div><div class="logo-t">ALTEORE</div></div>
  <div class="ns">Principal</div>
  <div class="ni" id="nav-dashboard" onclick="location.href='dashboard.html'"><span>ğŸ </span><span>Tableau de bord</span></div>
  <div class="ni" id="nav-suivi" onclick="location.href='suivi-ca.html'"><span>ğŸ“ˆ</span><span>Suivi CA & RÃ©sultats</span></div>
  <div class="ni" id="nav-kpis" onclick="toggleNav('kpis-sub',this)"><span>ğŸ¯</span><span style="flex:1">KPIs ClÃ©s</span><span class="chev" id="chev-kpis">â€º</span></div>
  <div class="sub" id="kpis-sub">
    <div class="si" onclick="location.href='cout-revient.html'"><span class="dot"></span>CoÃ»t de revient</div>
    <div class="si" onclick="location.href='marges.html'"><span class="dot"></span>Marge brute &amp; nette</div>
    <div class="si" onclick="location.href='panier-moyen.html'"><span class="dot"></span>Panier moyen</div>
  </div>
  <div class="ni" id="nav-pil" onclick="toggleNav('pil-sub',this)"><span>ğŸ§­</span><span style="flex:1">Pilotage</span><span class="chev" id="chev-pil">â€º</span></div>
  <div class="sub" id="pil-sub">
    <div class="si" onclick="location.href='pilotage.html?year=2025'"><span class="dot"></span>Pilotage 2025</div>
    <div class="si" onclick="location.href='pilotage.html?year=2026'"><span class="dot"></span>Pilotage 2026</div>
    <div class="si" onclick="location.href='pilotage.html?year=2027'"><span class="dot"></span>Pilotage 2027</div>
  </div>
  <div class="ni" onclick="location.href='dettes.html'"><span>ğŸ¦</span><span>Dettes &amp; Emprunts</span></div>
    <div class="ns">FidÃ©lisation</div>
  <div class="ni" onclick="toggleFidNav(this)"><span>ğŸ’</span><span style="flex:1">FidÃ©lisation</span><span style="font-size:11px;color:rgba(255,255,255,.3);transition:transform .25s;margin-left:auto" class="fid-chev">â€º</span></div>
  <div class="sub" id="fid-nav-sub">
    <div class="si" onclick="location.href='fidelisation.html'"><span class="dot"></span>Dashboard fidÃ©litÃ©</div>
    <div class="si" onclick="location.href='fidelisation.html';setTimeout(()=>switchTab&&switchTab('clients',null),300)"><span class="dot"></span>Clients</div>
    <div class="si" onclick="location.href='fidelisation.html';setTimeout(()=>switchTab&&switchTab('carte',null),300)"><span class="dot"></span>Carte fidÃ©litÃ©</div>
    <div class="si" onclick="location.href='fidelisation.html';setTimeout(()=>switchTab&&switchTab('points',null),300)"><span class="dot"></span>Points & RÃ©compenses</div>
    <div class="si" onclick="location.href='fidelisation.html';setTimeout(()=>switchTab&&switchTab('coupons',null),300)"><span class="dot"></span>Coupons & Offres</div>
    <div class="si" onclick="location.href='fidelisation.html';setTimeout(()=>switchTab&&switchTab('campagnes',null),300)"><span class="dot"></span>Campagnes</div>
  </div>
  <div class="ni" onclick="location.href='import.html'" style="border-top:1px solid rgba(255,255,255,.08);padding-top:10px"><span>ğŸ“¥</span><span>Import de donnÃ©es</span></div>
<div class="nav-footer">
    <div class="ucard" onclick="location.href=\'profil.html\'" style="cursor:pointer" title="Mon compte">
      <div class="uav" id="av">A</div>
      <div><div class="un" id="uname">Utilisateur</div><div class="upl" id="uplan">Plan gratuit</div></div>
      <button class="lbtn" onclick="doLogout()">â‹</button>
    </div>
  </div>
</nav>

<main>
  <div class="topbar">
    <div>
      <h1>ğŸ‘¤ Mon compte</h1>
      <p>Profil entreprise Â· Abonnement Â· Facturation</p>
    </div>
    <div class="tb-r">
      <button class="btn btn-o btn-xs" onclick="location.href='dashboard.html'">â† Dashboard</button>
      <button class="btn btn-p btn-xs" onclick="saveProfile()">ğŸ’¾ Enregistrer</button>
    </div>
  </div>

  <div class="page">

    <!-- HERO PROFIL -->
    <div class="hero">
      <div class="hero-logo" onclick="document.getElementById('logoInput').click()" title="Changer le logo">
        <span id="heroLogoEmoji">ğŸ¢</span>
        <img id="heroLogoImg" src="" style="display:none;width:100%;height:100%;object-fit:contain;border-radius:14px"/>
        <div class="hero-logo-hint">âœï¸</div>
      </div>
      <input type="file" id="logoInput" accept="image/*" onchange="handleLogo(this)"/>
      <div class="hero-info">
        <div class="hero-name" id="heroName">Votre entreprise</div>
        <div class="hero-sub" id="heroSub">Secteur Â· Forme juridique</div>
        <div class="hero-tags" id="heroTags"></div>
      </div>
      <div class="hero-right">
        <div class="plan-badge plan-gratuit" id="heroPlan" style="opacity:0">ğŸ‘‘</div>
        <div class="hero-member" id="heroMember">Membre depuis â€”</div>
      </div>
    </div>

    <!-- TABS -->
    <div class="tabs">
      <button class="tab on" onclick="switchTab('profil',this)">ğŸ¢ Profil entreprise</button>
      <button class="tab" onclick="switchTab('abonnement',this)">â­ Abonnement</button>
      <button class="tab" onclick="switchTab('factures',this)">ğŸ§¾ Mes factures</button>
      <button class="tab" onclick="switchTab('securite',this)">ğŸ”’ SÃ©curitÃ©</button>
    </div>

    <!-- â”€â”€ PANEL PROFIL â”€â”€ -->
    <div class="panel on" id="panel-profil">

      <!-- IdentitÃ© -->
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ¢ IdentitÃ© de l'entreprise</div></div>
        <div class="card-body">
          <div class="logo-upload" onclick="document.getElementById('logoInput').click()">
            <div class="logo-preview" id="logoPreview"><span id="logoEmoji">ğŸ¢</span><img id="logoImg" src="" style="display:none;width:100%;height:100%;object-fit:contain"/></div>
            <div class="logo-upload-text">
              <div>Logo de l'entreprise</div>
              <div>Cliquez pour uploader Â· PNG, JPG, SVG Â· Max 2 Mo</div>
            </div>
          </div>
          <div style="height:16px"></div>
          <div class="g2">
            <div class="field">
              <label>Nom de l'entreprise *</label>
              <div class="field-wrap"><input class="field-in" id="p-nom" placeholder="ex: PÃ¢tisserie Martin" oninput="updateHero()"/></div>
            </div>
            <div class="field">
              <label>Nom commercial</label>
              <div class="field-wrap"><input class="field-in" id="p-commercial" placeholder="ex: Chez Martin"/></div>
            </div>
            <div class="field">
              <label>Secteur d'activitÃ©</label>
              <div class="field-wrap">
                <select class="field-sel" id="p-secteur" onchange="updateHero()">
                  <option value="">â€” Choisir â€”</option>
                  <option>ğŸ¥ Boulangerie / PÃ¢tisserie</option>
                  <option>ğŸ½ï¸ Restauration</option>
                  <option>ğŸ›ï¸ Commerce de dÃ©tail</option>
                  <option>ğŸ’» Services numÃ©riques</option>
                  <option>ğŸ—ï¸ Artisanat / BTP</option>
                  <option>ğŸ’† Bien-Ãªtre / BeautÃ©</option>
                  <option>ğŸ¥ SantÃ© / MÃ©dical</option>
                  <option>ğŸ“š Ã‰ducation / Formation</option>
                  <option>ğŸšš Transport / Logistique</option>
                  <option>ğŸŒ¿ Agriculture / Alimentaire</option>
                  <option>ğŸ’¼ Conseil / Consulting</option>
                  <option>ğŸ  Immobilier</option>
                  <option>Autre</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label>Forme juridique</label>
              <div class="field-wrap">
                <select class="field-sel" id="p-forme" onchange="updateHero()">
                  <option value="">â€” Choisir â€”</option>
                  <option>Auto-entrepreneur / Micro-entreprise</option>
                  <option>EI â€” Entreprise individuelle</option>
                  <option>EIRL</option>
                  <option>EURL</option>
                  <option>SARL</option>
                  <option>SAS</option>
                  <option>SASU</option>
                  <option>SA</option>
                  <option>SNC</option>
                  <option>Association</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label>SIRET</label>
              <div class="field-wrap"><input class="field-in" id="p-siret" placeholder="xxx xxx xxx xxxxx" maxlength="17"/></div>
            </div>
            <div class="field">
              <label>NÂ° TVA intracommunautaire</label>
              <div class="field-wrap"><input class="field-in" id="p-tva" placeholder="FR xx xxxxxxxxx"/></div>
            </div>
            <div class="field field-full">
              <label>Description / ActivitÃ©</label>
              <div class="field-wrap"><input class="field-in" id="p-desc" placeholder="Courte description de votre activitÃ©..."/></div>
            </div>
          </div>
        </div>
      </div>

      <!-- CoordonnÃ©es -->
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ“ Adresse & CoordonnÃ©es</div></div>
        <div class="card-body">
          <div class="g2">
            <div class="field field-full">
              <label>Adresse</label>
              <div class="field-wrap"><input class="field-in" id="p-adresse" placeholder="12 rue des Fleurs"/></div>
            </div>
            <div class="field">
              <label>Code postal</label>
              <div class="field-wrap"><input class="field-in" id="p-cp" placeholder="75001"/></div>
            </div>
            <div class="field">
              <label>Ville</label>
              <div class="field-wrap"><input class="field-in" id="p-ville" placeholder="Paris"/></div>
            </div>
            <div class="field">
              <label>TÃ©lÃ©phone</label>
              <div class="field-wrap"><span class="field-unit">ğŸ“</span><input class="field-in" id="p-tel" placeholder="01 23 45 67 89" type="tel"/></div>
            </div>
            <div class="field">
              <label>Email professionnel</label>
              <div class="field-wrap"><span class="field-unit">âœ‰ï¸</span><input class="field-in" id="p-email" placeholder="contact@monentreprise.fr" type="email"/></div>
            </div>
            <div class="field">
              <label>Site web</label>
              <div class="field-wrap"><span class="field-unit">ğŸŒ</span><input class="field-in" id="p-web" placeholder="www.monentreprise.fr"/></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Infos bancaires -->
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ¦ Informations bancaires</div><span style="font-size:11px;color:var(--muted)">ğŸ”’ StockÃ©es localement, jamais transmises</span></div>
        <div class="card-body">
          <div class="g2">
            <div class="field">
              <label>Nom de la banque</label>
              <div class="field-wrap"><input class="field-in" id="p-banque" placeholder="BNP Paribas, CrÃ©dit Agricole..."/></div>
            </div>
            <div class="field">
              <label>Titulaire du compte</label>
              <div class="field-wrap"><input class="field-in" id="p-titulaire" placeholder="Nom de l'entreprise ou du gÃ©rant"/></div>
            </div>
            <div class="field field-full">
              <label>IBAN</label>
              <div class="field-wrap"><input class="field-in" id="p-iban" placeholder="FR76 xxxx xxxx xxxx xxxx xxxx xxx" maxlength="34" oninput="formatIBAN(this)"/></div>
            </div>
            <div class="field">
              <label>BIC / SWIFT</label>
              <div class="field-wrap"><input class="field-in" id="p-bic" placeholder="BNPAFRPP" maxlength="11"/></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Save -->
      <div class="save-bar">
        <span class="save-hint" id="lastSaved">Modifications non enregistrÃ©es</span>
        <button class="btn btn-p" onclick="saveProfile()">ğŸ’¾ Enregistrer le profil</button>
      </div>

    </div>

    <!-- â”€â”€ PANEL ABONNEMENT â”€â”€ -->
    <div class="panel" id="panel-abonnement">
      <div class="card">
        <div class="card-head">
          <div class="card-title">â­ Votre plan actuel</div>
          <button class="btn btn-o btn-xs" id="portalBtn" onclick="openStripePortal()" style="display:none">âš™ï¸ GÃ©rer mon abonnement</button>
        </div>
        <div class="card-body">

          <!-- BanniÃ¨re plan actuel -->
          <div style="display:flex;align-items:center;gap:16px;padding:16px;background:linear-gradient(135deg,#eff6ff,#e0eaff);border-radius:12px;margin-bottom:20px">
            <div style="font-size:32px" id="cur-plan-icon">â³</div>
            <div style="flex:1">
              <div style="font-size:16px;font-weight:800;color:var(--blue)" id="cur-plan-name">Chargement...</div>
              <div style="font-size:12px;color:var(--muted);margin-top:2px" id="cur-plan-desc">â€”</div>
            </div>
            <div style="text-align:right">
              <div style="font-size:22px;font-weight:800;color:var(--blue)" id="cur-plan-price">â€”</div>
              <div style="font-size:11px;color:var(--muted)" id="cur-plan-period"></div>
            </div>
          </div>

          <!-- Toggle mensuel / annuel -->
          <div style="display:flex;align-items:center;justify-content:center;gap:14px;margin-bottom:20px">
            <span style="font-size:13px;font-weight:700;color:var(--text)" id="lbl-m">Mensuel</span>
            <label style="position:relative;width:50px;height:26px;cursor:pointer;display:block;flex-shrink:0">
              <input type="checkbox" id="billing-tog" onchange="switchPlanBilling()" style="opacity:0;width:0;height:0;position:absolute"/>
              <span id="tog-bg" style="position:absolute;inset:0;background:#cbd5e1;border-radius:50px;transition:.3s"></span>
              <span id="tog-knob" style="position:absolute;width:20px;height:20px;top:3px;left:3px;background:#fff;border-radius:50%;transition:.3s;box-shadow:0 1px 3px rgba(0,0,0,.25)"></span>
            </label>
            <span style="font-size:13px;font-weight:600;color:var(--muted)" id="lbl-a">Annuel <span style="background:#fef3c7;color:#92400e;font-size:10px;font-weight:700;padding:2px 7px;border-radius:20px">âˆ’20%</span></span>
          </div>

          <div class="plan-grid">

            <!-- PRO -->
            <div class="plan-card" id="card-pro">
              <div class="plan-icon">ğŸ“Š</div>
              <div class="plan-name">Pro</div>
              <div style="font-size:28px;font-weight:900;color:var(--blue);margin:8px 0"><span id="price-pro" style="font-size:28px;font-weight:900;color:var(--blue)">69</span><span style="font-size:28px;font-weight:900;color:var(--blue)"> â‚¬</span><span style="font-size:13px;font-weight:500;color:var(--muted)"> /mois</span></div>
              <div style="font-size:11px;color:#10b981;font-weight:600;min-height:15px;margin-bottom:4px" id="note-pro"></div>
              <div class="plan-desc">Pilotage financier complet</div>
              <div class="plan-features">
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Dashboard & pilotage</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Marges, dettes, coÃ»t revient</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Import / Export donnÃ©es</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> FidÃ©lisation & SMS</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> Module RH</div>
              </div>
              <button class="plan-cta plan-cta-upgrade" id="cta-pro" onclick="startUpgrade('pro')">Essai 15j gratuit</button>
            </div>

            <!-- MAX -->
            <div class="plan-card popular" id="card-max">
              <div class="plan-icon">ğŸš€</div>
              <div class="plan-name">Max</div>
              <div style="font-size:28px;font-weight:900;color:var(--blue);margin:8px 0"><span id="price-max" style="font-size:28px;font-weight:900;color:var(--blue)">99</span><span style="font-size:28px;font-weight:900;color:var(--blue)"> â‚¬</span><span style="font-size:13px;font-weight:500;color:var(--muted)"> /mois</span></div>
              <div style="font-size:11px;color:#10b981;font-weight:600;min-height:15px;margin-bottom:4px" id="note-max"></div>
              <div class="plan-desc">Tout Pro + fidÃ©lisation</div>
              <div class="plan-features">
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Tout le plan Pro</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Carte fidÃ©litÃ© digitale</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Campagnes SMS</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Gestion clients complÃ¨te</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> Module RH</div>
              </div>
              <button class="plan-cta plan-cta-upgrade" id="cta-max" onclick="startUpgrade('max')">Essai 15j gratuit</button>
            </div>

            <!-- MASTER -->
            <div class="plan-card" id="card-master">
              <div class="plan-icon">ğŸ‘‘</div>
              <div class="plan-name">Master</div>
              <div style="font-size:28px;font-weight:900;color:var(--blue);margin:8px 0"><span id="price-master" style="font-size:28px;font-weight:900;color:var(--blue)">169</span><span style="font-size:28px;font-weight:900;color:var(--blue)"> â‚¬</span><span style="font-size:13px;font-weight:500;color:var(--muted)"> /mois</span></div>
              <div style="font-size:11px;color:#10b981;font-weight:600;min-height:15px;margin-bottom:4px" id="note-master"></div>
              <div class="plan-desc">Tout Max + module RH</div>
              <div class="plan-features">
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Tout le plan Max</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Module RH complet (Ã  venir)</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Support prioritaire</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> AccÃ¨s anticipÃ© features</div>
              </div>
              <button class="plan-cta plan-cta-upgrade" id="cta-master" onclick="startUpgrade('master')">Essai 15j gratuit</button>
            </div>

          </div>
          <div style="text-align:center;font-size:11px;color:var(--muted);margin-top:14px">ğŸ”’ Paiement sÃ©curisÃ© Stripe Â· Annulation Ã  tout moment Â· 15j d'essai gratuit</div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ PANEL FACTURES â”€â”€ -->
    <div class="panel" id="panel-factures">
      <div class="fact-kpis">
        <div class="fkpi green"><div class="fkpi-ico">âœ…</div><div class="fkpi-lbl">PayÃ©es</div><div class="fkpi-val" id="fk-payees">0 â‚¬</div><div class="fkpi-sub">Total rÃ©glÃ©</div></div>
        <div class="fkpi orange"><div class="fkpi-ico">â³</div><div class="fkpi-lbl">En attente</div><div class="fkpi-val" id="fk-attente">0 â‚¬</div><div class="fkpi-sub">Ã€ rÃ©gler</div></div>
        <div class="fkpi red"><div class="fkpi-ico">ğŸ”´</div><div class="fkpi-lbl">En retard</div><div class="fkpi-val" id="fk-retard">0 â‚¬</div><div class="fkpi-sub">ImpayÃ©es</div></div>
        <div class="fkpi blue"><div class="fkpi-ico">ğŸ§¾</div><div class="fkpi-lbl">Total facturÃ©</div><div class="fkpi-val" id="fk-total">0 â‚¬</div><div class="fkpi-sub">Cumul Altiora</div></div>
      </div>
      <div class="card">
        <div class="card-head">
          <div class="card-title">ğŸ§¾ Factures Altiora</div>
          <span style="font-size:11px;color:var(--muted)">Historique de vos abonnements</span>
        </div>
        <div style="overflow-x:auto">
          <table class="fact-table">
            <thead>
              <tr>
                <th>NÂ° Facture</th>
                <th>Date</th>
                <th>Description</th>
                <th>Montant HT</th>
                <th>TVA</th>
                <th>Total TTC</th>
                <th>Statut</th>
              </tr>
            </thead>
            <tbody id="facturesTbody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â”€â”€ PANEL SÃ‰CURITÃ‰ â”€â”€ -->
    <div class="panel" id="panel-securite">
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ”’ Compte & Connexion</div></div>
        <div class="card-body">
          <div class="g2">
            <div class="field">
              <label>Email de connexion</label>
              <div class="field-wrap"><input class="field-in" id="s-email" placeholder="â€”" readonly style="color:var(--muted)"/></div>
            </div>
            <div class="field">
              <label>Membre depuis</label>
              <div class="field-wrap"><input class="field-in" id="s-since" placeholder="â€”" readonly style="color:var(--muted)"/></div>
            </div>
          </div>
          <div style="margin-top:16px;padding:14px;background:#f8faff;border-radius:10px;font-size:12px;color:var(--muted)">
            ğŸ”’ La modification du mot de passe s'effectue via l'email de rÃ©initialisation. Contactez-nous Ã  <strong><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b1c2c4c1c1dec3c5f1d0ddc5d8dec3d09fd7c3">[email&#160;protected]</a></strong> pour toute demande.
          </div>
        </div>
      </div>
      <div class="danger-zone">
        <div class="danger-title">âš ï¸ Zone de danger</div>
        <div class="danger-sub">Ces actions sont irrÃ©versibles. RÃ©flÃ©chissez bien avant de continuer.</div>
        <div style="display:flex;gap:10px">
          <button class="btn-danger" onclick="exportData()">ğŸ“¤ Exporter mes donnÃ©es</button>
          <button class="btn-danger" onclick="if(confirm('Supprimer TOUTES vos donnÃ©es locales ?'))clearData()">ğŸ—‘ï¸ Effacer donnÃ©es locales</button>
        </div>
      </div>
    </div>

  </div>
</main>

<div class="toast" id="toast"></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>

// â•â•â• ABONNEMENT â•â•â•
const PLANS = {
  free:    { icon:'ğŸ”“', name:'Plan Gratuit',        desc:"AccÃ¨s limitÃ© â€” passez Ã  un plan payant", price:'Gratuit', period:'' },
  trial:   { icon:'â³', name:'Essai gratuit',        desc:"15 jours d'accÃ¨s complet", price:'Gratuit', period:'encore' },
  pro:     { icon:'ğŸ“Š', name:'Alteore Pro',          desc:"Pilotage financier complet + Import/Export", price:'69 â‚¬', period:'/mois' },
  max:     { icon:'ğŸš€', name:'Alteore Max',          desc:"Tout Pro + fidÃ©lisation client & SMS", price:'99 â‚¬', period:'/mois' },
  master:  { icon:'ğŸ‘‘', name:'Alteore Master',       desc:"Tout Max + module RH complet", price:'169 â‚¬', period:'/mois' },
  past_due:{ icon:'âš ï¸', name:'Paiement en attente', desc:"RÃ©glez votre facture pour rÃ©activer l'accÃ¨s", price:'â€”', period:'' },
  dev:     { icon:'ğŸ› ï¸', name:'Dev / Admin',          desc:"AccÃ¨s complet - Ã©quipe Alteore", price:'â€”', period:'' },
};
const PRICES = {
  pro:    { monthly:'price_1T3gqlGSYbSgNdWwlr6RX92r', annual:'price_1T3gveGSYbSgNdWwot2e5YpG' },
  max:    { monthly:'price_1T3gtkGSYbSgNdWw81ff10tt', annual:'price_1T3gwGGSYbSgNdWw1ptpHTDB' },
  master: { monthly:'price_1T3guhGSYbSgNdWwtKX6EFuy', annual:'price_1T3gwsGSYbSgNdWwezlggjJR' },
};
const MONTHLY = {pro:69, max:99, master:169};
const ANNUAL  = {pro:55, max:79, master:135};
const ANNUAL_TOTAL = {pro:662, max:950, master:1622};

let _isAnnual = false;
let _currentPlan = 'trial';

function loadPlanUI(plan) {
  _currentPlan = plan || 'trial';
  const p = PLANS[_currentPlan] || PLANS.trial;
  document.getElementById('cur-plan-icon').textContent = p.icon;
  document.getElementById('cur-plan-name').textContent = p.name;
  document.getElementById('cur-plan-desc').textContent = p.desc;
  document.getElementById('cur-plan-price').textContent = p.price;
  document.getElementById('cur-plan-period').textContent = p.period;
  // Badge hero
  const badge = document.getElementById('heroPlan');
  if (badge) {
    badge.textContent = p.icon + ' ' + p.name;
    badge.className = 'plan-badge ' + (_currentPlan === 'trial' ? 'plan-gratuit' : _currentPlan === 'master' ? 'plan-business' : 'plan-pro');
  }
  // Sidebar
  const upl = document.getElementById('uplan');
  if (upl) upl.textContent = p.name;
  // Marquer le plan actuel sur les cards
  ['pro','max','master'].forEach(pl => {
    const card = document.getElementById('card-' + pl);
    const cta = document.getElementById('cta-' + pl);
    if (!card || !cta) return;
    card.classList.remove('current');
    cta.className = 'plan-cta plan-cta-upgrade';
    cta.textContent = 'Essai 15j gratuit';
    cta.disabled = false;
    cta.onclick = function(){ startUpgrade(pl); };
    if (pl === _currentPlan) {
      card.classList.add('current');
      cta.className = 'plan-cta plan-cta-current';
      cta.textContent = 'Plan actuel';
      cta.disabled = true;
    }
  });
  // Bouton portail Stripe
  const portalBtn = document.getElementById('portalBtn');
  if (portalBtn) portalBtn.style.display = (_currentPlan !== 'trial' && _currentPlan !== 'dev') ? 'inline-flex' : 'none';
}

function switchPlanBilling() {
  _isAnnual = document.getElementById('billing-tog').checked;
  const bg = document.getElementById('tog-bg');
  const knob = document.getElementById('tog-knob');
  if (bg) bg.style.background = _isAnnual ? 'linear-gradient(135deg,#1a3dce,#4f7ef8)' : '#cbd5e1';
  if (knob) knob.style.transform = _isAnnual ? 'translateX(24px)' : 'translateX(0)';
  document.getElementById('lbl-m').style.color = _isAnnual ? 'var(--muted)' : 'var(--text)';
  document.getElementById('lbl-a').style.color = _isAnnual ? 'var(--text)' : 'var(--muted)';
  ['pro','max','master'].forEach(pl => {
    const priceEl = document.getElementById('price-' + pl);
    const noteEl = document.getElementById('note-' + pl);
    if (priceEl) priceEl.textContent = _isAnnual ? ANNUAL[pl] : MONTHLY[pl];
    if (noteEl) noteEl.textContent = _isAnnual ? 'FacturÃ© ' + ANNUAL_TOTAL[pl] + ' â‚¬/an' : '';
  });
}

async function startUpgrade(plan) {
  const btn = document.getElementById('cta-' + plan);
  if (btn) { btn.disabled = true; btn.textContent = 'â³ Chargement...'; }
  try {
    const priceId = PRICES[plan][_isAnnual ? 'annual' : 'monthly'];
    const uid = window._uid || '';
    const email = window._auth?.currentUser?.email || '';
    const res = await fetch('/api/create-subscription-checkout', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ priceId, plan, billing: _isAnnual ? 'annual' : 'monthly', uid, email })
    });
    const data = await res.json();
    if (data.url) { window.location.href = data.url; }
    else { throw new Error(data.error || 'Erreur Stripe'); }
  } catch(e) {
    showToastMsg('Erreur : ' + e.message, 'err');
    if (btn) { btn.disabled = false; btn.textContent = 'Essai 15j gratuit'; }
  }
}

async function openStripePortal() {
  const btn = document.getElementById('portalBtn');
  if (btn) { btn.disabled = true; btn.textContent = 'â³...'; }
  try {
    const uid = window._uid || '';
    const res = await fetch('/api/stripe-portal', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ uid })
    });
    const data = await res.json();
    if (data.url) { window.location.href = data.url; }
    else { throw new Error(data.error || 'Erreur portail'); }
  } catch(e) {
    showToastMsg('Erreur : ' + e.message, 'err');
    if (btn) { btn.disabled = false; btn.textContent = 'âš™ï¸ GÃ©rer mon abonnement'; }
  }
}

// â”€â”€ TABS â”€â”€
function switchTab(id, el) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('on'));
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('on'));
  el.classList.add('on');
  document.getElementById('panel-' + id).classList.add('on');
}

function toggleNav(subId, el) {
  document.getElementById(subId).classList.toggle('open');
  el.classList.toggle('on');
}

async function doLogout() {
  try { if (window._signOut && window._auth) await window._signOut(window._auth); } catch (e) {}
  location.href = 'index.html';
}

// â”€â”€ UTILS â”€â”€
function fe(n) { return (parseFloat(n)||0).toLocaleString('fr-FR',{minimumFractionDigits:2,maximumFractionDigits:2})+' â‚¬'; }
function set(id, v) { const e = document.getElementById(id); if (e) e.textContent = v; }
function showToastMsg(msg, type) { const t = document.getElementById('toast'); t.textContent = msg; t.className = 'toast show ' + (type||''); setTimeout(() => t.className = 'toast', 3000); }

// â”€â”€ LOGO â”€â”€
function handleLogo(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    const src = e.target.result;
    localStorage.setItem('altiora_logo', src);
    applyLogo(src);
  };
  reader.readAsDataURL(file);
}

function applyLogo(src) {
  if (!src) return;
  // Hero
  document.getElementById('heroLogoEmoji').style.display = 'none';
  const hli = document.getElementById('heroLogoImg'); hli.src = src; hli.style.display = 'block';
  // Card
  document.getElementById('logoEmoji').style.display = 'none';
  const li = document.getElementById('logoImg'); li.src = src; li.style.display = 'block';
  // Sidebar avatar
  document.getElementById('av').style.background = 'transparent';
  document.getElementById('av').innerHTML = `<img src="${src}" style="width:100%;height:100%;object-fit:contain;border-radius:5px"/>`;
}

// â”€â”€ FORMAT IBAN â”€â”€
function formatIBAN(input) {
  let v = input.value.replace(/\s/g,'').toUpperCase();
  input.value = v.replace(/(.{4})/g, '$1 ').trim();
}

// â”€â”€ HERO UPDATE â”€â”€
function updateHero() {
  const nom = document.getElementById('p-nom').value || 'Votre entreprise';
  const secteur = document.getElementById('p-secteur').value;
  const forme = document.getElementById('p-forme').value;
  document.getElementById('heroName').textContent = nom;
  document.getElementById('heroSub').textContent = [secteur, forme].filter(Boolean).join(' Â· ') || 'ComplÃ©tez votre profil';
  // Tags
  const tags = [];
  const siret = document.getElementById('p-siret').value;
  const ville = document.getElementById('p-ville').value;
  if (siret) tags.push('SIRET ' + siret);
  if (ville) tags.push('ğŸ“ ' + ville);
  document.getElementById('heroTags').innerHTML = tags.map(t => `<span class="hero-tag">${t}</span>`).join('');
  // Sidebar
  document.getElementById('uname').textContent = nom;
  document.getElementById('av').textContent = nom[0]?.toUpperCase() || 'A';
}

// â”€â”€ SAVE / LOAD â”€â”€
function saveProfile() {
  const fields = ['nom','commercial','secteur','forme','siret','tva','desc','adresse','cp','ville','tel','email','web','banque','titulaire','iban','bic'];
  const data = {};
  fields.forEach(f => { const el = document.getElementById('p-'+f); if (el) data[f] = el.value; });
  localStorage.setItem('altiora_profil', JSON.stringify(data));
  document.getElementById('lastSaved').textContent = 'âœ… EnregistrÃ© le ' + new Date().toLocaleString('fr-FR');
  showToastMsg('âœ… Profil enregistrÃ© !', 'ok');
  updateHero();
  // Firebase sync
  if (window._uid && window._setDoc) {
    window._setDoc(window._doc(window._db,'profil',window._uid,'data','profil'), data, {merge:true}).catch(() => {});
  }
}

function loadProfile() {
  try {
    const raw = localStorage.getItem('altiora_profil');
    if (!raw) return;
    const data = JSON.parse(raw);
    Object.keys(data).forEach(f => { const el = document.getElementById('p-'+f); if (el) el.value = data[f] || ''; });
    updateHero();
    const logo = localStorage.getItem('altiora_logo');
    if (logo) applyLogo(logo);
  } catch (e) {}
}

// â”€â”€ FACTURES DEMO â”€â”€
const FACTURES_DEMO = [
  {num:'ALT-2025-001', date:'2025-01-01', desc:'Abonnement Gratuit â€” Janvier 2025', ht:0,   tva:0,    ttc:0,    statut:'payee'},
  {num:'ALT-2025-002', date:'2025-02-01', desc:'Abonnement Gratuit â€” FÃ©vrier 2025', ht:0,   tva:0,    ttc:0,    statut:'payee'},
  {num:'ALT-2025-003', date:'2025-03-01', desc:'Abonnement Gratuit â€” Mars 2025',    ht:0,   tva:0,    ttc:0,    statut:'payee'},
];

function renderFactures() {
  const tbody = document.getElementById('facturesTbody');
  const facts = JSON.parse(localStorage.getItem('altiora_factures') || 'null') || FACTURES_DEMO;
  let payees=0, attente=0, retard=0, total=0;
  facts.forEach(f => {
    total += f.ttc;
    if (f.statut==='payee') payees += f.ttc;
    else if (f.statut==='attente') attente += f.ttc;
    else if (f.statut==='retard') retard += f.ttc;
  });
  set('fk-payees', fe(payees)); set('fk-attente', fe(attente));
  set('fk-retard', fe(retard)); set('fk-total', fe(total));

  const statusHtml = {
    payee:   '<span class="status-badge status-payee">âœ… PayÃ©e</span>',
    attente: '<span class="status-badge status-attente">â³ En attente</span>',
    retard:  '<span class="status-badge status-retard">ğŸ”´ En retard</span>',
  };

  tbody.innerHTML = facts.map(f => `<tr>
    <td><strong>${f.num}</strong></td>
    <td>${new Date(f.date).toLocaleDateString('fr-FR')}</td>
    <td>${f.desc}</td>
    <td>${f.ht===0?'Gratuit':fe(f.ht)}</td>
    <td>${f.tva===0?'â€”':fe(f.tva)}</td>
    <td><strong>${f.ttc===0?'Gratuit':fe(f.ttc)}</strong></td>
    <td>${statusHtml[f.statut]||''}</td>
  </tr>`).join('') || '<tr><td colspan="7" style="text-align:center;padding:24px;color:var(--muted)">Aucune facture</td></tr>';
}

// â”€â”€ SECURITE â”€â”€
function exportData() {
  const data = {
    profil: JSON.parse(localStorage.getItem('altiora_profil')||'{}'),
    dettes: JSON.parse(localStorage.getItem('altiora_dettes')||'[]'),
  };
  const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='altiora-export.json'; a.click();
  showToastMsg('ğŸ“¤ Export tÃ©lÃ©chargÃ© !','ok');
}

function clearData() {
  ['altiora_profil','altiora_logo','altiora_dettes','altiora_pm_2025','altiora_pm_2026'].forEach(k => localStorage.removeItem(k));
  showToastMsg('ğŸ—‘ï¸ DonnÃ©es effacÃ©es','ok');
  setTimeout(() => location.reload(), 1200);
}

// â”€â”€ FIREBASE â”€â”€
async function tryFirebase() {
  if (!window._uid || !window._getDoc) return;
  try {
    // Auth info
    const user = window._auth?.currentUser;
    if (user) {
      const email = user.email || '';
      const created = user.metadata?.creationTime ? new Date(user.metadata.creationTime).toLocaleDateString('fr-FR') : 'â€”';
      document.getElementById('s-email').value = email;
      document.getElementById('s-since').value = created;
      document.getElementById('heroMember').textContent = 'Membre depuis ' + created;
    }
    // Load profil
    const snap = await window._getDoc(window._doc(window._db,'profil',window._uid,'data','profil'));
    if (snap.exists()) {
      const data = snap.data();
      Object.keys(data).forEach(f => { const el = document.getElementById('p-'+f); if (el) el.value = data[f]||''; });
      updateHero();
    }
    // Load plan
    const planSnap = await window._getDoc(window._doc(window._db,'users',window._uid));
    if (planSnap.exists()) {
      const userData = planSnap.data();
      loadPlanUI(userData.plan || 'free');
    } else {
      loadPlanUI('free');
    }
  } catch (e) { loadPlanUI('free'); }
}

// â”€â”€ START â”€â”€
loadProfile();
renderFactures();
setTimeout(tryFirebase, 500);
</script>

<script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import{getAuth,onAuthStateChanged,signOut}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import{getFirestore,doc,setDoc,getDoc}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const app = initializeApp({
  apiKey: "AIzaSyB003WqdRKrT0gbv7P4BNIICuXeqbu8dR4",
  authDomain: "altiora-70599.firebaseapp.com",
  projectId: "altiora-70599",
  storageBucket: "altiora-70599.firebasestorage.app",
  messagingSenderId: "120905555746",
  appId: "1:120905555746:web:618460c65cdc9e57cc8f7b"
});

const auth = getAuth(app);
const db   = getFirestore(app);

window._auth    = auth;
window._db      = db;
window._doc     = doc;
window._setDoc  = setDoc;
window._getDoc  = getDoc;
window._signOut = signOut;

onAuthStateChanged(auth, async function(user) {
  if (!user) { window.location.href = 'index.html'; return; }
  window._uid = user.uid;
  window._firebaseReady = true;

  // MÃ j sidebar nom + avatar
  const av = document.getElementById('av');
  if (av) av.textContent = (user.displayName || user.email || 'U')[0].toUpperCase();
  const un = document.getElementById('uname');
  if (un) un.textContent = user.displayName || user.email || 'Utilisateur';

  // MÃ j sÃ©curitÃ©
  const emailEl = document.getElementById('s-email');
  if (emailEl) emailEl.value = user.email || '';
  if (user.metadata && user.metadata.creationTime) {
    const created = new Date(user.metadata.creationTime).toLocaleDateString('fr-FR');
    const sinceEl = document.getElementById('s-since');
    if (sinceEl) sinceEl.value = created;
    const heroMember = document.getElementById('heroMember');
    if (heroMember) heroMember.textContent = 'Membre depuis ' + created;
  }

  // â”€â”€ CHARGER LE PLAN DIRECTEMENT DANS LE MODULE â”€â”€
  const PLAN_NAMES = { free:'Plan Gratuit', trial:'Essai gratuit', pro:'Alteore Pro', max:'Alteore Max', master:'Alteore Master', past_due:'Paiement en attente', dev:'Dev / Admin' };
  const PLAN_ICONS = { free:'ğŸ”“', trial:'â³', pro:'ğŸ“Š', max:'ğŸš€', master:'ğŸ‘‘', past_due:'âš ï¸', dev:'ğŸ› ï¸' };

  function applyPlanBadge(plan) {
    const badge = document.getElementById('heroPlan');
    const uplan = document.getElementById('uplan');
    const name = PLAN_NAMES[plan] || plan;
    const icon = PLAN_ICONS[plan] || '';
    if (badge) {
      badge.textContent = icon + ' ' + name;
      badge.className = 'plan-badge ' + (plan === 'master' || plan === 'max' ? 'plan-business' : plan === 'pro' ? 'plan-pro' : 'plan-gratuit');
      badge.style.opacity = '1';
    }
    if (uplan) uplan.textContent = name;
    // Appeler aussi loadPlanUI si disponible pour mÃ j des cards
    if (typeof window.loadPlanUI === 'function') window.loadPlanUI(plan);
  }

  try {
    const planSnap = await getDoc(doc(db, 'users', user.uid));
    const plan = planSnap.exists() ? (planSnap.data().plan || 'free') : 'free';
    applyPlanBadge(plan);
  } catch(e) {
    console.error('Erreur plan:', e);
    applyPlanBadge('free');
  }

  // â”€â”€ CHARGER LE PROFIL â”€â”€
  try {
    const snap = await getDoc(doc(db, 'profil', user.uid, 'data', 'profil'));
    if (snap.exists()) {
      const data = snap.data();
      Object.keys(data).forEach(function(f) {
        const el = document.getElementById('p-'+f);
        if (el) el.value = data[f] || '';
      });
      if (typeof window.updateHero === 'function') window.updateHero();
    }
  } catch(e) {}
});
</script>
</body>
</html>
