<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover"/>
<title>ALTIORA â€” Mon Compte</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet"/>
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --blue:#1a3dce;--blue2:#4f7ef8;--bg:#f4f6fb;--white:#fff;
  --border:#e2e8f0;--text:#1a1f36;--muted:#6b7280;
  --green:#10b981;--red:#ef4444;--orange:#f59e0b;--purple:#6366f1;
  --radius:14px;--sw:250px;
}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--text);display:flex;min-height:100vh;font-size:13px}

/* NAV */
nav{width:var(--sw);min-height:100vh;background:linear-gradient(180deg,#0f1f5c,#162366);position:fixed;top:0;left:0;display:flex;flex-direction:column;padding-bottom:20px;overflow-y:auto;z-index:99}
.logo{display:flex;align-items:center;gap:10px;padding:22px 18px;border-bottom:1px solid rgba(255,255,255,.08)}
.logo-i{width:33px;height:33px;background:rgba(255,255,255,.14);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px}
.logo-t{font-size:17px;font-weight:800;color:#fff;letter-spacing:1px}
.ns{font-size:10px;font-weight:700;color:rgba(255,255,255,.28);letter-spacing:1px;text-transform:uppercase;padding:12px 18px 4px}
.ni{display:flex;align-items:center;gap:9px;padding:9px 18px;color:rgba(255,255,255,.55);font-size:12.5px;font-weight:500;cursor:pointer;border-left:3px solid transparent;transition:.15s}
.ni:hover{color:#fff;background:rgba(255,255,255,.06)}
.ni.on{color:#fff;background:rgba(255,255,255,.1);border-left-color:#4f7ef8}
.sub{overflow:hidden;max-height:0;transition:max-height .3s}
.sub.open{max-height:200px}
.si{display:flex;align-items:center;gap:7px;padding:7px 18px 7px 40px;color:rgba(255,255,255,.4);font-size:12px;cursor:pointer;border-left:3px solid transparent;transition:.15s}
.si:hover{color:rgba(255,255,255,.75);background:rgba(255,255,255,.04)}
.si.on{color:#fff;background:rgba(79,126,248,.15);border-left-color:rgba(79,126,248,.6)}
.dot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.25)}
.si.on .dot{background:#4f7ef8}
.chev{font-size:11px;color:rgba(255,255,255,.3);transition:transform .25s;margin-left:auto}
.nav-footer{margin-top:auto;padding:12px 18px 0;border-top:1px solid rgba(255,255,255,.08)}
.ucard{display:flex;align-items:center;gap:8px;padding:8px;background:rgba(255,255,255,.07);border-radius:8px}
.uav{width:29px;height:29px;background:linear-gradient(135deg,#4f7ef8,#6366f1);border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff}
.un{font-size:11.5px;font-weight:600;color:#fff}
.upl{font-size:10px;color:rgba(255,255,255,.3)}
.lbtn{margin-left:auto;background:none;border:none;color:rgba(255,255,255,.3);cursor:pointer;font-size:13px}

/* MAIN */
main{margin-left:var(--sw);flex:1;display:flex;flex-direction:column}
.topbar{background:#fff;border-bottom:1px solid var(--border);padding:12px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:50}
.topbar h1{font-size:16px;font-weight:700}
.topbar p{font-size:11px;color:var(--muted)}
.tb-r{display:flex;gap:8px;align-items:center}
.btn{padding:7px 14px;border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;transition:.15s;display:inline-flex;align-items:center;gap:5px}
.btn-p{background:linear-gradient(135deg,var(--blue),var(--blue2));color:#fff;box-shadow:0 3px 10px rgba(26,61,206,.2)}
.btn-o{background:#fff;color:var(--blue);border:1.5px solid var(--border)}
.btn-o:hover{border-color:var(--blue2)}
.btn-xs{padding:4px 10px;font-size:11px}

/* PAGE */
.page{padding:20px 24px;display:flex;flex-direction:column;gap:20px}

/* PROFIL HERO */
.hero{background:linear-gradient(135deg,#0f1f5c,#1a3dce,#4f7ef8);border-radius:var(--radius);padding:28px 32px;display:flex;align-items:center;gap:24px;color:#fff;position:relative;overflow:hidden}
.hero::before{content:'';position:absolute;right:-40px;top:-40px;width:200px;height:200px;border-radius:50%;background:rgba(255,255,255,.05)}
.hero::after{content:'';position:absolute;right:60px;bottom:-60px;width:150px;height:150px;border-radius:50%;background:rgba(255,255,255,.04)}
.hero-logo{width:72px;height:72px;background:rgba(255,255,255,.15);border:2px solid rgba(255,255,255,.25);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:30px;cursor:pointer;flex-shrink:0;position:relative;transition:.2s}
.hero-logo:hover{background:rgba(255,255,255,.22)}
.hero-logo-hint{position:absolute;bottom:-6px;right:-6px;width:20px;height:20px;background:var(--blue2);border:2px solid #fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px}
.hero-info{flex:1;min-width:0}
.hero-name{font-size:22px;font-weight:800;margin-bottom:4px}
.hero-sub{font-size:13px;opacity:.7;margin-bottom:8px}
.hero-tags{display:flex;gap:8px;flex-wrap:wrap}
.hero-tag{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.2)}
.hero-right{text-align:right;flex-shrink:0}
.plan-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:700;margin-bottom:8px}
.plan-gratuit{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.3);color:#fff}
.plan-pro{background:linear-gradient(135deg,#f59e0b,#fbbf24);color:#1a1f36}
.plan-business{background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff}
.hero-member{font-size:11px;opacity:.5}

/* TABS */
.tabs{display:flex;gap:2px;background:#f1f5f9;border-radius:10px;padding:4px;width:fit-content}
.tab{padding:7px 18px;border-radius:7px;font-size:12px;font-weight:600;cursor:pointer;color:var(--muted);transition:.15s;border:none;background:transparent;font-family:'Plus Jakarta Sans',sans-serif}
.tab.on{background:#fff;color:var(--blue);box-shadow:0 1px 4px rgba(0,0,0,.1)}

/* PANELS */
.panel{display:none}.panel.on{display:flex;flex-direction:column;gap:16px}

/* CARDS */
.card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.card-head{padding:14px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:#f8faff}
.card-title{font-size:13px;font-weight:700;display:flex;align-items:center;gap:7px}
.card-body{padding:20px}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}

/* FIELDS */
.field{display:flex;flex-direction:column;gap:5px}
.field label{font-size:11px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.4px}
.field-wrap{display:flex;align-items:center;gap:8px;padding:9px 13px;border:1.5px solid var(--border);border-radius:10px;background:#f8faff;transition:.15s}
.field-wrap:focus-within{border-color:var(--blue2);background:#fff;box-shadow:0 0 0 3px rgba(79,126,248,.1)}
.field-in{flex:1;border:none;background:transparent;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;color:var(--text);outline:none}
.field-in::placeholder{color:#cbd5e1;font-weight:400}
.field-sel{flex:1;border:none;background:transparent;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;color:var(--text);outline:none;cursor:pointer}
.field-unit{font-size:11px;font-weight:700;color:var(--muted)}
.field-full{grid-column:1/-1}

/* LOGO UPLOAD */
.logo-upload{display:flex;align-items:center;gap:16px;padding:16px;background:#f8faff;border:2px dashed var(--border);border-radius:10px;cursor:pointer;transition:.15s}
.logo-upload:hover{border-color:var(--blue2);background:#eff6ff}
.logo-preview{width:56px;height:56px;border-radius:10px;background:#e2e8f0;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;overflow:hidden}
.logo-preview img{width:100%;height:100%;object-fit:contain}
.logo-upload-text div:first-child{font-size:13px;font-weight:700;color:var(--text);margin-bottom:2px}
.logo-upload-text div:last-child{font-size:11px;color:var(--muted)}

/* PLAN CARDS */
.plan-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.plan-card{background:#fff;border:2px solid var(--border);border-radius:var(--radius);padding:20px;text-align:center;cursor:pointer;transition:.2s;position:relative}
.plan-card:hover{border-color:var(--blue2);transform:translateY(-2px);box-shadow:0 8px 24px rgba(79,126,248,.12)}
.plan-card.current{border-color:var(--blue);box-shadow:0 0 0 3px rgba(79,126,248,.12)}
.plan-card.current::after{content:'âœ“ Plan actuel';position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:var(--blue);color:#fff;font-size:10px;font-weight:700;padding:2px 10px;border-radius:20px}
.plan-card.popular::before{content:'â­ Populaire';position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:var(--orange);color:#fff;font-size:10px;font-weight:700;padding:2px 10px;border-radius:20px}
.plan-icon{font-size:28px;margin-bottom:10px}
.plan-name{font-size:15px;font-weight:800;margin-bottom:4px}
.plan-price{font-size:26px;font-weight:800;color:var(--blue);margin:8px 0}
.plan-price span{font-size:13px;font-weight:500;color:var(--muted)}
.plan-desc{font-size:11px;color:var(--muted);margin-bottom:14px}
.plan-features{text-align:left;display:flex;flex-direction:column;gap:6px;font-size:12px}
.plan-feat{display:flex;align-items:center;gap:7px}
.plan-feat.ok{color:var(--text)}
.plan-feat.no{color:var(--muted);text-decoration:line-through}
.plan-feat-icon{flex-shrink:0}
.plan-cta{margin-top:16px;width:100%;padding:9px;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer;border:none;transition:.15s}
.plan-cta-current{background:#f1f5f9;color:var(--muted);cursor:default}
.plan-cta-upgrade{background:linear-gradient(135deg,var(--blue),var(--blue2));color:#fff}

/* FACTURES */
.fact-kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.fkpi{background:#fff;border:1px solid var(--border);border-radius:12px;padding:14px 16px}
.fkpi.green{background:#f0fdf4;border-color:#bbf7d0}
.fkpi.orange{background:#fffbeb;border-color:#fde68a}
.fkpi.red{background:#fef2f2;border-color:#fecaca}
.fkpi.blue{background:#eff6ff;border-color:#bfdbfe}
.fkpi-ico{font-size:18px;margin-bottom:4px}
.fkpi-lbl{font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.3px}
.fkpi-val{font-size:18px;font-weight:800;margin-top:2px}
.fkpi-sub{font-size:10px;color:var(--muted);margin-top:1px}

/* TABLE FACTURES */
.fact-table{width:100%;border-collapse:collapse;font-size:12px}
.fact-table th{padding:9px 14px;text-align:left;font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;background:#f8faff;border-bottom:1px solid var(--border)}
.fact-table td{padding:11px 14px;border-bottom:1px solid #f1f5f9;vertical-align:middle}
.fact-table tr:hover td{background:#fafbff}
.status-badge{display:inline-flex;align-items:center;gap:4px;padding:3px 9px;border-radius:20px;font-size:11px;font-weight:700}
.status-payee{background:#d1fae5;color:#065f46}
.status-attente{background:#fef3c7;color:#92400e}
.status-retard{background:#fee2e2;color:#b91c1c}
.dl-btn{padding:4px 10px;border:1.5px solid var(--border);border-radius:6px;background:#fff;font-family:'Plus Jakarta Sans',sans-serif;font-size:11px;font-weight:600;cursor:pointer;color:var(--blue);transition:.15s}
.dl-btn:hover{border-color:var(--blue2);background:#eff6ff}

/* DANGER ZONE */
.danger-zone{background:#fff;border:1.5px solid #fecaca;border-radius:var(--radius);padding:20px}
.danger-title{font-size:13px;font-weight:700;color:var(--red);margin-bottom:4px}
.danger-sub{font-size:12px;color:var(--muted);margin-bottom:14px}
.btn-danger{background:#fef2f2;color:var(--red);border:1.5px solid #fecaca;padding:8px 16px;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer}
.btn-danger:hover{background:#fee2e2}

/* SAVE BAR */
.save-bar{position:sticky;bottom:0;background:#fff;border-top:1px solid var(--border);padding:12px 24px;display:flex;align-items:center;justify-content:space-between;margin:-20px -24px 0;z-index:10}
.save-hint{font-size:12px;color:var(--muted)}

/* TOAST */
.toast{position:fixed;bottom:18px;right:18px;padding:10px 16px;border-radius:9px;font-size:13px;font-weight:600;z-index:9999;transform:translateY(60px);opacity:0;transition:.3s}
.toast.show{transform:translateY(0);opacity:1}
.toast.ok{background:#10b981;color:#fff}
.toast.err{background:#ef4444;color:#fff}

input[type=file]{display:none}


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE / IPHONE SAFARI â€” ALTIORA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* RESET overflow global */
html { overflow-x: hidden; }
body { overflow-x: hidden; max-width: 100vw; }

/* HAMBURGER â€” toujours cachÃ© sur desktop */
.hamburger {
  display: none;
  position: fixed;
  top: 14px;
  left: 14px;
  z-index: 1000;
  width: 42px;
  height: 42px;
  background: #0f1f5c;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 5px;
  box-shadow: 0 3px 14px rgba(15,31,92,.5);
  -webkit-tap-highlight-color: transparent;
}
.hamburger span {
  display: block;
  width: 20px;
  height: 2px;
  background: #fff;
  border-radius: 2px;
  transition: all .25s ease;
  pointer-events: none;
}
.hamburger.open span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
.hamburger.open span:nth-child(2) { opacity: 0; transform: scaleX(0); }
.hamburger.open span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

/* OVERLAY */
.nav-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.5);
  z-index: 998;
  -webkit-tap-highlight-color: transparent;
}
.nav-overlay.show { display: block; }

/* â”€â”€ MOBILE UNIQUEMENT â”€â”€ */
@media (max-width: 768px) {

  .hamburger { display: flex !important; }

  /* SIDEBAR DRAWER */
  nav, .sidebar {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    height: 100vh !important;
    height: -webkit-fill-available !important;
    width: min(275px, 82vw) !important;
    z-index: 999 !important;
    transform: translateX(-110%) !important;
    transition: transform .3s cubic-bezier(.4,0,.2,1) !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    margin: 0 !important;
  }
  nav.open, .sidebar.open {
    transform: translateX(0) !important;
    box-shadow: 6px 0 30px rgba(0,0,0,.3) !important;
  }

  /* MAIN */
  main, .main-content, .main {
    margin-left: 0 !important;
    width: 100vw !important;
    overflow-x: hidden !important;
  }

  /* TOPBAR */
  .topbar {
    padding: 10px 12px 10px 64px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 50 !important;
    background: #fff !important;
    box-shadow: 0 1px 6px rgba(0,0,0,.08) !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
  }
  .topbar h1 { font-size: 14px !important; }
  .topbar p { display: none !important; }
  .tb-r { gap: 5px !important; }
  .tb-r .btn { padding: 6px 10px !important; font-size: 11px !important; min-height: 34px !important; }

  /* PAGE */
  .page {
    padding: 12px 10px !important;
    gap: 12px !important;
    overflow-x: hidden !important;
    width: 100% !important;
    box-sizing: border-box !important;
  }

  /* EMPÃŠCHER TOUT DÃ‰BORDEMENT */
  .page > * { max-width: 100% !important; box-sizing: border-box !important; }

  /* GRILLES â†’ 1 COLONNE */
  .kpi-row { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .g2, .g3, .charts-row, .fields-grid,
  .mgrid2, .sim-g, .detail-grid,
  .results-row, .plan-grid, .cats,
  .fact-kpis, .type-grid {
    grid-template-columns: 1fr !important;
    gap: 10px !important;
  }
  .fact-kpis { grid-template-columns: 1fr 1fr !important; }

  /* CARDS */
  .card { width: 100% !important; overflow: hidden !important; }

  /* TABLEAUX â€” scroll interne */
  .echeancier-wrap, .table-scroll, [class*="table-wrap"] {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    width: 100% !important;
  }
  table { min-width: 520px; font-size: 11px !important; }
  /* Wrapper auto sur les tableaux sans wrapper */
  .card > div > table, .card-body > table {
    display: block;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  /* INPUTS TOUCH-FRIENDLY */
  input, select, textarea {
    font-size: 16px !important;
    -webkit-appearance: none !important;
  }
  .field-wrap, .mfield-wrap, .sim-fw {
    min-height: 46px !important;
    padding: 10px 12px !important;
  }
  .field-in, .mfield-in, .sim-fi {
    font-size: 16px !important;
  }

  /* BOUTONS TOUCH */
  .btn { min-height: 40px !important; }
  .btn-xs { min-height: 36px !important; }

  /* MONTH STRIP â€” scroll horizontal */
  .month-strip {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    flex-wrap: nowrap !important;
    padding-bottom: 6px !important;
    width: 100% !important;
  }
  .mbtn { flex-shrink: 0 !important; }

  /* YEAR BAR */
  .yr-bar {
    overflow-x: auto !important;
    flex-wrap: nowrap !important;
    -webkit-overflow-scrolling: touch !important;
  }
  .yr { flex-shrink: 0 !important; }

  /* TABS */
  .tabs {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    flex-wrap: nowrap !important;
    width: 100% !important;
    padding-bottom: 2px !important;
  }
  .tab { flex-shrink: 0 !important; white-space: nowrap !important; }

  /* SAISIE */
  .saisie-head { flex-direction: column !important; gap: 8px !important; align-items: flex-start !important; }

  /* DETTE */
  .dette-head { flex-wrap: wrap !important; gap: 8px !important; }
  .dette-stats { flex-direction: column !important; align-items: flex-start !important; gap: 4px !important; }

  /* HERO */
  .hero { flex-direction: column !important; text-align: center !important; padding: 16px !important; gap: 12px !important; }
  .hero-right { text-align: center !important; }
  .hero-tags { justify-content: center !important; }
  .hero-name { font-size: 17px !important; }

  /* MODAL â€” bottom sheet */
  .overlay { align-items: flex-end !important; padding: 0 !important; }
  .modal {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    border-radius: 18px 18px 0 0 !important;
    max-height: 90vh !important;
  }

  /* CANVAS */
  canvas { max-width: 100% !important; }

  /* SECTION HEAD */
  .section-head { flex-wrap: wrap !important; gap: 8px !important; }

  /* SIM RESULT */
  .sim-rg { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .sim-res { padding: 14px !important; }

  /* CALENDAR */
  .calendar-grid { grid-template-columns: repeat(3, 1fr) !important; gap: 5px !important; }

  /* USER CARD dans sidebar */
  .ucard, .user-card { cursor: pointer !important; }
}

@media (max-width: 420px) {
  .kpi-row, .fact-kpis { grid-template-columns: 1fr !important; }
  .sim-rg { grid-template-columns: 1fr !important; }
  .calendar-grid { grid-template-columns: repeat(2, 1fr) !important; }
}

</style>
</head>
<body>
  <button class="hamburger" id="hamburger" onclick="toggleSidebar()" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
  <div class="nav-overlay" id="navOverlay" onclick="closeSidebar()"></div>

<nav>
  <div class="logo"><div class="logo-i">ğŸ“Š</div><div class="logo-t">ALTIORA</div></div>
  <div class="ns">Principal</div>
  <div class="ni" id="nav-dashboard" onclick="location.href='dashboard.html'"><span>ğŸ </span><span>Tableau de bord</span></div>
  <div class="ni" id="nav-suivi" onclick="location.href='suivi-ca.html'"><span>ğŸ“ˆ</span><span>Suivi CA & RÃ©sultats</span></div>
  <div class="ni" id="nav-kpis" onclick="toggleNav('kpis-sub',this)"><span>ğŸ¯</span><span style="flex:1">KPIs ClÃ©s</span><span class="chev" id="chev-kpis">â€º</span></div>
  <div class="sub" id="kpis-sub">
    <div class="si" onclick="location.href='cout-revient.html'"><span class="dot"></span>CoÃ»t de revient</div>
    <div class="si" onclick="location.href='marges.html'"><span class="dot"></span>Marge brute &amp; nette</div>
    <div class="si" onclick="location.href='panier-moyen.html'"><span class="dot"></span>Panier moyen</div>
  </div>
  <div class="ni" id="nav-pil" onclick="toggleNav('pil-sub',this)"><span>ğŸ§­</span><span style="flex:1">Pilotage</span><span class="chev" id="chev-pil">â€º</span></div>
  <div class="sub" id="pil-sub">
    <div class="si" onclick="location.href='pilotage.html?year=2025'"><span class="dot"></span>Pilotage 2025</div>
    <div class="si" onclick="location.href='pilotage.html?year=2026'"><span class="dot"></span>Pilotage 2026</div>
    <div class="si" onclick="location.href='pilotage.html?year=2027'"><span class="dot"></span>Pilotage 2027</div>
  </div>
  <div class="ni" onclick="location.href='dettes.html'"><span>ğŸ¦</span><span>Dettes &amp; Emprunts</span></div>
  <div class="nav-footer">
    <div class="ucard" onclick="location.href=\'profil.html\'" style="cursor:pointer" title="Mon compte">
      <div class="uav" id="av">A</div>
      <div><div class="un" id="uname">Utilisateur</div><div class="upl" id="uplan">Plan gratuit</div></div>
      <button class="lbtn" onclick="doLogout()">â‹</button>
    </div>
  </div>
</nav>

<main>
  <div class="topbar">
    <div>
      <h1>ğŸ‘¤ Mon compte</h1>
      <p>Profil entreprise Â· Abonnement Â· Facturation</p>
    </div>
    <div class="tb-r">
      <button class="btn btn-o btn-xs" onclick="location.href='dashboard.html'">â† Dashboard</button>
      <button class="btn btn-p btn-xs" onclick="saveProfile()">ğŸ’¾ Enregistrer</button>
    </div>
  </div>

  <div class="page">

    <!-- HERO PROFIL -->
    <div class="hero">
      <div class="hero-logo" onclick="document.getElementById('logoInput').click()" title="Changer le logo">
        <span id="heroLogoEmoji">ğŸ¢</span>
        <img id="heroLogoImg" src="" style="display:none;width:100%;height:100%;object-fit:contain;border-radius:14px"/>
        <div class="hero-logo-hint">âœï¸</div>
      </div>
      <input type="file" id="logoInput" accept="image/*" onchange="handleLogo(this)"/>
      <div class="hero-info">
        <div class="hero-name" id="heroName">Votre entreprise</div>
        <div class="hero-sub" id="heroSub">Secteur Â· Forme juridique</div>
        <div class="hero-tags" id="heroTags"></div>
      </div>
      <div class="hero-right">
        <div class="plan-badge plan-gratuit" id="heroPlan">ğŸ†“ Plan Gratuit</div>
        <div class="hero-member" id="heroMember">Membre depuis â€”</div>
      </div>
    </div>

    <!-- TABS -->
    <div class="tabs">
      <button class="tab on" onclick="switchTab('profil',this)">ğŸ¢ Profil entreprise</button>
      <button class="tab" onclick="switchTab('abonnement',this)">â­ Abonnement</button>
      <button class="tab" onclick="switchTab('factures',this)">ğŸ§¾ Mes factures</button>
      <button class="tab" onclick="switchTab('securite',this)">ğŸ”’ SÃ©curitÃ©</button>
    </div>

    <!-- â”€â”€ PANEL PROFIL â”€â”€ -->
    <div class="panel on" id="panel-profil">

      <!-- IdentitÃ© -->
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ¢ IdentitÃ© de l'entreprise</div></div>
        <div class="card-body">
          <div class="logo-upload" onclick="document.getElementById('logoInput').click()">
            <div class="logo-preview" id="logoPreview"><span id="logoEmoji">ğŸ¢</span><img id="logoImg" src="" style="display:none;width:100%;height:100%;object-fit:contain"/></div>
            <div class="logo-upload-text">
              <div>Logo de l'entreprise</div>
              <div>Cliquez pour uploader Â· PNG, JPG, SVG Â· Max 2 Mo</div>
            </div>
          </div>
          <div style="height:16px"></div>
          <div class="g2">
            <div class="field">
              <label>Nom de l'entreprise *</label>
              <div class="field-wrap"><input class="field-in" id="p-nom" placeholder="ex: PÃ¢tisserie Martin" oninput="updateHero()"/></div>
            </div>
            <div class="field">
              <label>Nom commercial</label>
              <div class="field-wrap"><input class="field-in" id="p-commercial" placeholder="ex: Chez Martin"/></div>
            </div>
            <div class="field">
              <label>Secteur d'activitÃ©</label>
              <div class="field-wrap">
                <select class="field-sel" id="p-secteur" onchange="updateHero()">
                  <option value="">â€” Choisir â€”</option>
                  <option>ğŸ¥ Boulangerie / PÃ¢tisserie</option>
                  <option>ğŸ½ï¸ Restauration</option>
                  <option>ğŸ›ï¸ Commerce de dÃ©tail</option>
                  <option>ğŸ’» Services numÃ©riques</option>
                  <option>ğŸ—ï¸ Artisanat / BTP</option>
                  <option>ğŸ’† Bien-Ãªtre / BeautÃ©</option>
                  <option>ğŸ¥ SantÃ© / MÃ©dical</option>
                  <option>ğŸ“š Ã‰ducation / Formation</option>
                  <option>ğŸšš Transport / Logistique</option>
                  <option>ğŸŒ¿ Agriculture / Alimentaire</option>
                  <option>ğŸ’¼ Conseil / Consulting</option>
                  <option>ğŸ  Immobilier</option>
                  <option>Autre</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label>Forme juridique</label>
              <div class="field-wrap">
                <select class="field-sel" id="p-forme" onchange="updateHero()">
                  <option value="">â€” Choisir â€”</option>
                  <option>Auto-entrepreneur / Micro-entreprise</option>
                  <option>EI â€” Entreprise individuelle</option>
                  <option>EIRL</option>
                  <option>EURL</option>
                  <option>SARL</option>
                  <option>SAS</option>
                  <option>SASU</option>
                  <option>SA</option>
                  <option>SNC</option>
                  <option>Association</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label>SIRET</label>
              <div class="field-wrap"><input class="field-in" id="p-siret" placeholder="xxx xxx xxx xxxxx" maxlength="17"/></div>
            </div>
            <div class="field">
              <label>NÂ° TVA intracommunautaire</label>
              <div class="field-wrap"><input class="field-in" id="p-tva" placeholder="FR xx xxxxxxxxx"/></div>
            </div>
            <div class="field field-full">
              <label>Description / ActivitÃ©</label>
              <div class="field-wrap"><input class="field-in" id="p-desc" placeholder="Courte description de votre activitÃ©..."/></div>
            </div>
          </div>
        </div>
      </div>

      <!-- CoordonnÃ©es -->
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ“ Adresse & CoordonnÃ©es</div></div>
        <div class="card-body">
          <div class="g2">
            <div class="field field-full">
              <label>Adresse</label>
              <div class="field-wrap"><input class="field-in" id="p-adresse" placeholder="12 rue des Fleurs"/></div>
            </div>
            <div class="field">
              <label>Code postal</label>
              <div class="field-wrap"><input class="field-in" id="p-cp" placeholder="75001"/></div>
            </div>
            <div class="field">
              <label>Ville</label>
              <div class="field-wrap"><input class="field-in" id="p-ville" placeholder="Paris"/></div>
            </div>
            <div class="field">
              <label>TÃ©lÃ©phone</label>
              <div class="field-wrap"><span class="field-unit">ğŸ“</span><input class="field-in" id="p-tel" placeholder="01 23 45 67 89" type="tel"/></div>
            </div>
            <div class="field">
              <label>Email professionnel</label>
              <div class="field-wrap"><span class="field-unit">âœ‰ï¸</span><input class="field-in" id="p-email" placeholder="contact@monentreprise.fr" type="email"/></div>
            </div>
            <div class="field">
              <label>Site web</label>
              <div class="field-wrap"><span class="field-unit">ğŸŒ</span><input class="field-in" id="p-web" placeholder="www.monentreprise.fr"/></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Infos bancaires -->
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ¦ Informations bancaires</div><span style="font-size:11px;color:var(--muted)">ğŸ”’ StockÃ©es localement, jamais transmises</span></div>
        <div class="card-body">
          <div class="g2">
            <div class="field">
              <label>Nom de la banque</label>
              <div class="field-wrap"><input class="field-in" id="p-banque" placeholder="BNP Paribas, CrÃ©dit Agricole..."/></div>
            </div>
            <div class="field">
              <label>Titulaire du compte</label>
              <div class="field-wrap"><input class="field-in" id="p-titulaire" placeholder="Nom de l'entreprise ou du gÃ©rant"/></div>
            </div>
            <div class="field field-full">
              <label>IBAN</label>
              <div class="field-wrap"><input class="field-in" id="p-iban" placeholder="FR76 xxxx xxxx xxxx xxxx xxxx xxx" maxlength="34" oninput="formatIBAN(this)"/></div>
            </div>
            <div class="field">
              <label>BIC / SWIFT</label>
              <div class="field-wrap"><input class="field-in" id="p-bic" placeholder="BNPAFRPP" maxlength="11"/></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Save -->
      <div class="save-bar">
        <span class="save-hint" id="lastSaved">Modifications non enregistrÃ©es</span>
        <button class="btn btn-p" onclick="saveProfile()">ğŸ’¾ Enregistrer le profil</button>
      </div>

    </div>

    <!-- â”€â”€ PANEL ABONNEMENT â”€â”€ -->
    <div class="panel" id="panel-abonnement">
      <div class="card">
        <div class="card-head"><div class="card-title">â­ Votre plan actuel</div></div>
        <div class="card-body">
          <div style="display:flex;align-items:center;gap:16px;padding:16px;background:linear-gradient(135deg,#eff6ff,#e0eaff);border-radius:12px;margin-bottom:20px">
            <div style="font-size:32px">ğŸ†“</div>
            <div>
              <div style="font-size:16px;font-weight:800;color:var(--blue)">Plan Gratuit</div>
              <div style="font-size:12px;color:var(--muted);margin-top:2px">AccÃ¨s aux fonctionnalitÃ©s de base Â· DonnÃ©es stockÃ©es localement</div>
            </div>
            <div style="margin-left:auto;text-align:right">
              <div style="font-size:22px;font-weight:800;color:var(--blue)">0 â‚¬</div>
              <div style="font-size:11px;color:var(--muted)">/ mois</div>
            </div>
          </div>
          <div class="plan-grid">
            <div class="plan-card current">
              <div class="plan-icon">ğŸ†“</div>
              <div class="plan-name">Gratuit</div>
              <div class="plan-price">0 â‚¬<span> /mois</span></div>
              <div class="plan-desc">Pour dÃ©marrer et tester</div>
              <div class="plan-features">
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Tableau de bord</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Suivi CA</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> CoÃ»t de revient</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Marges</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Panier moyen</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> Pilotage avancÃ©</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> Export PDF</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> Multi-utilisateurs</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> Support prioritaire</div>
              </div>
              <button class="plan-cta plan-cta-current" disabled>Plan actuel</button>
            </div>
            <div class="plan-card popular">
              <div class="plan-icon">â­</div>
              <div class="plan-name">Pro</div>
              <div class="plan-price">29 â‚¬<span> /mois</span></div>
              <div class="plan-desc">Pour les entrepreneurs actifs</div>
              <div class="plan-features">
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Tout du gratuit</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Pilotage avancÃ©</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Export PDF & Excel</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Alertes automatiques</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Sauvegarde cloud</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Support email</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> Multi-utilisateurs</div>
                <div class="plan-feat no"><span class="plan-feat-icon">âŒ</span> API access</div>
              </div>
              <button class="plan-cta plan-cta-upgrade" onclick="showToastMsg('ğŸš€ BientÃ´t disponible !','ok')">Passer au Pro</button>
            </div>
            <div class="plan-card">
              <div class="plan-icon">ğŸš€</div>
              <div class="plan-name">Business</div>
              <div class="plan-price">79 â‚¬<span> /mois</span></div>
              <div class="plan-desc">Pour les Ã©quipes et PME</div>
              <div class="plan-features">
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Tout du Pro</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Multi-utilisateurs (5)</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> API access</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Tableau de bord Ã©quipe</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Support tÃ©lÃ©phonique</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Onboarding personnalisÃ©</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> SLA garanti 99.9%</div>
                <div class="plan-feat ok"><span class="plan-feat-icon">âœ…</span> Factures personnalisÃ©es</div>
              </div>
              <button class="plan-cta plan-cta-upgrade" onclick="showToastMsg('ğŸš€ BientÃ´t disponible !','ok')">Contacter</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ PANEL FACTURES â”€â”€ -->
    <div class="panel" id="panel-factures">
      <div class="fact-kpis">
        <div class="fkpi green"><div class="fkpi-ico">âœ…</div><div class="fkpi-lbl">PayÃ©es</div><div class="fkpi-val" id="fk-payees">0 â‚¬</div><div class="fkpi-sub">Total rÃ©glÃ©</div></div>
        <div class="fkpi orange"><div class="fkpi-ico">â³</div><div class="fkpi-lbl">En attente</div><div class="fkpi-val" id="fk-attente">0 â‚¬</div><div class="fkpi-sub">Ã€ rÃ©gler</div></div>
        <div class="fkpi red"><div class="fkpi-ico">ğŸ”´</div><div class="fkpi-lbl">En retard</div><div class="fkpi-val" id="fk-retard">0 â‚¬</div><div class="fkpi-sub">ImpayÃ©es</div></div>
        <div class="fkpi blue"><div class="fkpi-ico">ğŸ§¾</div><div class="fkpi-lbl">Total facturÃ©</div><div class="fkpi-val" id="fk-total">0 â‚¬</div><div class="fkpi-sub">Cumul Altiora</div></div>
      </div>
      <div class="card">
        <div class="card-head">
          <div class="card-title">ğŸ§¾ Factures Altiora</div>
          <span style="font-size:11px;color:var(--muted)">Historique de vos abonnements</span>
        </div>
        <div style="overflow-x:auto">
          <table class="fact-table">
            <thead>
              <tr>
                <th>NÂ° Facture</th>
                <th>Date</th>
                <th>Description</th>
                <th>Montant HT</th>
                <th>TVA</th>
                <th>Total TTC</th>
                <th>Statut</th>
              </tr>
            </thead>
            <tbody id="facturesTbody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â”€â”€ PANEL SÃ‰CURITÃ‰ â”€â”€ -->
    <div class="panel" id="panel-securite">
      <div class="card">
        <div class="card-head"><div class="card-title">ğŸ”’ Compte & Connexion</div></div>
        <div class="card-body">
          <div class="g2">
            <div class="field">
              <label>Email de connexion</label>
              <div class="field-wrap"><input class="field-in" id="s-email" placeholder="â€”" readonly style="color:var(--muted)"/></div>
            </div>
            <div class="field">
              <label>Membre depuis</label>
              <div class="field-wrap"><input class="field-in" id="s-since" placeholder="â€”" readonly style="color:var(--muted)"/></div>
            </div>
          </div>
          <div style="margin-top:16px;padding:14px;background:#f8faff;border-radius:10px;font-size:12px;color:var(--muted)">
            ğŸ”’ La modification du mot de passe s'effectue via l'email de rÃ©initialisation. Contactez-nous Ã  <strong><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b1c2c4c1c1dec3c5f1d0ddc5d8dec3d09fd7c3">[email&#160;protected]</a></strong> pour toute demande.
          </div>
        </div>
      </div>
      <div class="danger-zone">
        <div class="danger-title">âš ï¸ Zone de danger</div>
        <div class="danger-sub">Ces actions sont irrÃ©versibles. RÃ©flÃ©chissez bien avant de continuer.</div>
        <div style="display:flex;gap:10px">
          <button class="btn-danger" onclick="exportData()">ğŸ“¤ Exporter mes donnÃ©es</button>
          <button class="btn-danger" onclick="if(confirm('Supprimer TOUTES vos donnÃ©es locales ?'))clearData()">ğŸ—‘ï¸ Effacer donnÃ©es locales</button>
        </div>
      </div>
    </div>

  </div>
</main>

<div class="toast" id="toast"></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
// â”€â”€ TABS â”€â”€
function switchTab(id, el) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('on'));
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('on'));
  el.classList.add('on');
  document.getElementById('panel-' + id).classList.add('on');
}

function toggleNav(subId, el) {
  document.getElementById(subId).classList.toggle('open');
  el.classList.toggle('on');
}

async function doLogout() {
  try { if (window._signOut && window._auth) await window._signOut(window._auth); } catch (e) {}
  location.href = 'index.html';
}

// â”€â”€ UTILS â”€â”€
function fe(n) { return (parseFloat(n)||0).toLocaleString('fr-FR',{minimumFractionDigits:2,maximumFractionDigits:2})+' â‚¬'; }
function set(id, v) { const e = document.getElementById(id); if (e) e.textContent = v; }
function showToastMsg(msg, type) { const t = document.getElementById('toast'); t.textContent = msg; t.className = 'toast show ' + (type||''); setTimeout(() => t.className = 'toast', 3000); }

// â”€â”€ LOGO â”€â”€
function handleLogo(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    const src = e.target.result;
    localStorage.setItem('altiora_logo', src);
    applyLogo(src);
  };
  reader.readAsDataURL(file);
}

function applyLogo(src) {
  if (!src) return;
  // Hero
  document.getElementById('heroLogoEmoji').style.display = 'none';
  const hli = document.getElementById('heroLogoImg'); hli.src = src; hli.style.display = 'block';
  // Card
  document.getElementById('logoEmoji').style.display = 'none';
  const li = document.getElementById('logoImg'); li.src = src; li.style.display = 'block';
  // Sidebar avatar
  document.getElementById('av').style.background = 'transparent';
  document.getElementById('av').innerHTML = `<img src="${src}" style="width:100%;height:100%;object-fit:contain;border-radius:5px"/>`;
}

// â”€â”€ FORMAT IBAN â”€â”€
function formatIBAN(input) {
  let v = input.value.replace(/\s/g,'').toUpperCase();
  input.value = v.replace(/(.{4})/g, '$1 ').trim();
}

// â”€â”€ HERO UPDATE â”€â”€
function updateHero() {
  const nom = document.getElementById('p-nom').value || 'Votre entreprise';
  const secteur = document.getElementById('p-secteur').value;
  const forme = document.getElementById('p-forme').value;
  document.getElementById('heroName').textContent = nom;
  document.getElementById('heroSub').textContent = [secteur, forme].filter(Boolean).join(' Â· ') || 'ComplÃ©tez votre profil';
  // Tags
  const tags = [];
  const siret = document.getElementById('p-siret').value;
  const ville = document.getElementById('p-ville').value;
  if (siret) tags.push('SIRET ' + siret);
  if (ville) tags.push('ğŸ“ ' + ville);
  document.getElementById('heroTags').innerHTML = tags.map(t => `<span class="hero-tag">${t}</span>`).join('');
  // Sidebar
  document.getElementById('uname').textContent = nom;
  document.getElementById('av').textContent = nom[0]?.toUpperCase() || 'A';
}

// â”€â”€ SAVE / LOAD â”€â”€
function saveProfile() {
  const fields = ['nom','commercial','secteur','forme','siret','tva','desc','adresse','cp','ville','tel','email','web','banque','titulaire','iban','bic'];
  const data = {};
  fields.forEach(f => { const el = document.getElementById('p-'+f); if (el) data[f] = el.value; });
  localStorage.setItem('altiora_profil', JSON.stringify(data));
  document.getElementById('lastSaved').textContent = 'âœ… EnregistrÃ© le ' + new Date().toLocaleString('fr-FR');
  showToastMsg('âœ… Profil enregistrÃ© !', 'ok');
  updateHero();
  // Firebase sync
  if (window._uid && window._setDoc) {
    window._setDoc(window._doc(window._db,'profil',window._uid,'data','profil'), data, {merge:true}).catch(() => {});
  }
}

function loadProfile() {
  try {
    const raw = localStorage.getItem('altiora_profil');
    if (!raw) return;
    const data = JSON.parse(raw);
    Object.keys(data).forEach(f => { const el = document.getElementById('p-'+f); if (el) el.value = data[f] || ''; });
    updateHero();
    const logo = localStorage.getItem('altiora_logo');
    if (logo) applyLogo(logo);
  } catch (e) {}
}

// â”€â”€ FACTURES DEMO â”€â”€
const FACTURES_DEMO = [
  {num:'ALT-2025-001', date:'2025-01-01', desc:'Abonnement Gratuit â€” Janvier 2025', ht:0,   tva:0,    ttc:0,    statut:'payee'},
  {num:'ALT-2025-002', date:'2025-02-01', desc:'Abonnement Gratuit â€” FÃ©vrier 2025', ht:0,   tva:0,    ttc:0,    statut:'payee'},
  {num:'ALT-2025-003', date:'2025-03-01', desc:'Abonnement Gratuit â€” Mars 2025',    ht:0,   tva:0,    ttc:0,    statut:'payee'},
];

function renderFactures() {
  const tbody = document.getElementById('facturesTbody');
  const facts = JSON.parse(localStorage.getItem('altiora_factures') || 'null') || FACTURES_DEMO;
  let payees=0, attente=0, retard=0, total=0;
  facts.forEach(f => {
    total += f.ttc;
    if (f.statut==='payee') payees += f.ttc;
    else if (f.statut==='attente') attente += f.ttc;
    else if (f.statut==='retard') retard += f.ttc;
  });
  set('fk-payees', fe(payees)); set('fk-attente', fe(attente));
  set('fk-retard', fe(retard)); set('fk-total', fe(total));

  const statusHtml = {
    payee:   '<span class="status-badge status-payee">âœ… PayÃ©e</span>',
    attente: '<span class="status-badge status-attente">â³ En attente</span>',
    retard:  '<span class="status-badge status-retard">ğŸ”´ En retard</span>',
  };

  tbody.innerHTML = facts.map(f => `<tr>
    <td><strong>${f.num}</strong></td>
    <td>${new Date(f.date).toLocaleDateString('fr-FR')}</td>
    <td>${f.desc}</td>
    <td>${f.ht===0?'Gratuit':fe(f.ht)}</td>
    <td>${f.tva===0?'â€”':fe(f.tva)}</td>
    <td><strong>${f.ttc===0?'Gratuit':fe(f.ttc)}</strong></td>
    <td>${statusHtml[f.statut]||''}</td>
  </tr>`).join('') || '<tr><td colspan="7" style="text-align:center;padding:24px;color:var(--muted)">Aucune facture</td></tr>';
}

// â”€â”€ SECURITE â”€â”€
function exportData() {
  const data = {
    profil: JSON.parse(localStorage.getItem('altiora_profil')||'{}'),
    dettes: JSON.parse(localStorage.getItem('altiora_dettes')||'[]'),
  };
  const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='altiora-export.json'; a.click();
  showToastMsg('ğŸ“¤ Export tÃ©lÃ©chargÃ© !','ok');
}

function clearData() {
  ['altiora_profil','altiora_logo','altiora_dettes','altiora_pm_2025','altiora_pm_2026'].forEach(k => localStorage.removeItem(k));
  showToastMsg('ğŸ—‘ï¸ DonnÃ©es effacÃ©es','ok');
  setTimeout(() => location.reload(), 1200);
}

// â”€â”€ FIREBASE â”€â”€
async function tryFirebase() {
  if (!window._uid || !window._getDoc) return;
  try {
    // Auth info
    const user = window._auth?.currentUser;
    if (user) {
      const email = user.email || '';
      const created = user.metadata?.creationTime ? new Date(user.metadata.creationTime).toLocaleDateString('fr-FR') : 'â€”';
      document.getElementById('s-email').value = email;
      document.getElementById('s-since').value = created;
      document.getElementById('heroMember').textContent = 'Membre depuis ' + created;
    }
    // Load profil
    const snap = await window._getDoc(window._doc(window._db,'profil',window._uid,'data','profil'));
    if (snap.exists()) {
      const data = snap.data();
      Object.keys(data).forEach(f => { const el = document.getElementById('p-'+f); if (el) el.value = data[f]||''; });
      updateHero();
    }
  } catch (e) {}
}

// â”€â”€ START â”€â”€
loadProfile();
renderFactures();
setTimeout(tryFirebase, 500);
</script>

<script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import{getAuth,onAuthStateChanged,signOut}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import{getFirestore,doc,setDoc,getDoc}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
const app=initializeApp({apiKey:"AIzaSyB003WqdRKrT0gbv7P4BNIICuXeqbu8dR4",authDomain:"altiora-70599.firebaseapp.com",projectId:"altiora-70599",storageBucket:"altiora-70599.firebasestorage.app",messagingSenderId:"120905555746",appId:"1:120905555746:web:618460c65cdc9e57cc8f7b"});
const auth=getAuth(app),db=getFirestore(app);
window._auth=auth;window._db=db;window.